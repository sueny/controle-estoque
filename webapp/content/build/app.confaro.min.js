!function(){"use strict";angular.module("app",["ui.router","toastService","ngMaterial"]).config(["$httpProvider",function(a){}])}(),function(){"use strict";function a(a){function t(t){this.message=t,a.show({controller:"toastController",controllerAs:"vm",templateUrl:"controle-estoque-web/client/views/forms/toast.html",action:"OK",highlightAction:!0,position:"top right",hideDelay:2e3})}function e(t){this.message=t,a.show({controller:"toastController",controllerAs:"vm",templateUrl:"views/pages/dsctoast.html",action:"OK",highlightAction:!0,position:"bottom left",hideDelay:1e3})}var r={message:"",newmessage:t,errorMessageBottom:e};return r}angular.module("toastService",[]).controller("toastController",["$mdToast","toastApp",function(a,t){var e=this;e.message=t.message,e.closeToast=function(){a.hide()}}]).factory("toastApp",a),a.$inject=["$mdToast"]}(),function(){"use strict";function a(a,t,e){a.state("cadastroMateriaPrima",{url:"/",templateUrl:e.staticPath+"views/forms/cad_materiaprima.html",controller:"cadastroMateriaPrimaController as vm"}),t.otherwise("/")}angular.module("app").config(a),a.$inject=["$stateProvider","$urlRouterProvider","paths"]}(),function(){"use strict";function a(a,t,e){function r(){l.listaUnidades=["Kg","m"]}function i(a){l.materiaprima=a,l.isBtnRemoveMateriaPrima=!0}function o(){t.listarTodas().success(function(a){console.log(a),l.listaMateriaPrima=a})}function s(r,i){var o=e.confirm().parent(angular.element(document.body)).title("Excluir Matéria prima com Sku"+i.skuCode).content("Materia Prima: "+i.name).ariaLabel("Excluir Materia Prima").ok("Sim").cancel("Não").targetEvent(r);e.show(o).then(function(){t.excluir(i).success(function(t){if(t){for(var e=0;e<l.listaMateriaPrima.length;e++)l.listaMateriaPrima[e].id===i.id,l.listaMateriaPrima.splice(e,1);a.newmessage("Removido com sucesso!.")}else a.newmessage("Problema ao Acessar o servidor")});for(var e=0;e<l.listaMateriaPrima.length;e++)if(console.log(l.listaMateriaPrima[e].id+" === "+i.id),l.listaMateriaPrima[e].id===i.id){l.listaMateriaPrima.splice(e,1);break}l.isBtnRemoveMateriaPrima=!1,a.newmessage("Removido a Materia Prima com o SKU."+i.sku),l.materiaprima={id:null,name:"",skuCode:"",measuringUnit:"",description:""}})}function n(e){t.cadastrar(e).success(function(t){console.log(t),t?(l.listaMateriaPrima.push(e),a.newmessage("Cadastro realizado com sucesso!")):a.newmessage("Problema ao Acessar a o servidor")})}function c(a){l.reverse=l.campoOrdencao===a?!l.reverse:!1,l.campoOrdencao=a}var l=this;l.initcadastroMateriaPrima=o,l.cadastrarMateriaPrima=n,l.buscaUnidadesMateriaPrima=r,l.excluirMateriaPrima=s,l.listaUnidades,l.isBtnRemoveMateriaPrima=!1,l.materiaprima={},l.listaMateriaPrima=[],l.selecionarMateriaPrima=i,l.campoOrdencao="nome",l.reverse=!0,l.ordenaMateriaPrima=c,l.materialCategories=[]}angular.module("app").controller("cadastroMateriaPrimaController",a),a.$inject=["toastApp","materiaPrimaService","$mdDialog"]}(),function(){"use strict";function a(a,t){function e(t){return a.post(o,t)}function r(t){return a.post(s,t)}function i(){return a.post(n)}var o=t.apiUrl+"materialcategory/cadastrar/",s=t.apiUrl+"materialcategory/remover/",n=t.apiUrl+"materialcategory/listar/",c={cadastrar:e,excluir:r,listarTodas:i};return c}angular.module("app").factory("materialCategoryService",a),a.$inject=["$http","paths","$location"]}(),function(){"use strict";function a(a,t){function e(t){return a.post(o,t)}function r(t){return a.post(s,t)}function i(){return a.post(n)}var o=t.apiUrl+"material/cadastrar/",s=t.apiUrl+"material/remover/",n=t.apiUrl+"material/listar/",c={cadastrar:e,excluir:r,listarTodas:i};return c}angular.module("app").factory("materiaPrimaService",a),a.$inject=["$http","paths","$location"]}(),function(){"use strict";function a(a){a.theme("default").primaryPalette("purple",{"default":"400","hue-1":"100","hue-2":"600","hue-3":"A100"}).accentPalette("purple",{"default":"200"})}var t="",e="http://localhost:8080/controle-estoque-web/api/";angular.module("app").constant("paths",{staticPath:t,apiUrl:e}).config(a),a.$inject=["$mdThemingProvider","$locationProvider"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZhcm8uYXBwLmpzIiwidG9hc3Quc2VydmljZS5qcyIsInJvdXRlci5hcHAuanMiLCJhcHAuY29uZmFyby5taW4uanMiLCJjYWRhc3Ryby9jYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIuanMiLCJzZXJ2aWNlL3NlcnZpY2VNYXRlcmlhbENhdGVnb3J5LmpzIiwic2VydmljZS9zZXJ2aWNlTWF0ZXJpYVByaW1hLmpzIiwiYXBwLWNvbmZpZy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsInRvYXN0QXBwIiwiJG1kVG9hc3QiLCJuZXdtZXNzYWdlIiwiZXJyb3JNZXNzYWdlIiwidGhpcyIsIm1lc3NhZ2UiLCJzaG93IiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlVXJsIiwiYWN0aW9uIiwiaGlnaGxpZ2h0QWN0aW9uIiwicG9zaXRpb24iLCJoaWRlRGVsYXkiLCJlcnJvck1lc3NhZ2VCb3R0b20iLCJzZXJ2aWNlIiwic2VsZiIsImNsb3NlVG9hc3QiLCJoaWRlIiwiZmFjdG9yeSIsIiRpbmplY3QiLCJyb3V0ZXMiLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsInBhdGhzIiwic3RhdGUiLCJ1cmwiLCJzdGF0aWNQYXRoIiwib3RoZXJ3aXNlIiwiY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyIiwibWF0ZXJpYVByaW1hU2VydmljZSIsIiRtZERpYWxvZyIsImJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEiLCJsaXN0YVVuaWRhZGVzIiwic2VsZWNpb25hck1hdGVyaWFQcmltYSIsIm1hdGVyaWFQcmltYSIsIm1hdGVyaWFwcmltYSIsImlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hIiwiaW5pdGNhZGFzdHJvTWF0ZXJpYVByaW1hIiwibGlzdGFyVG9kYXMiLCJzdWNjZXNzIiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJsaXN0YU1hdGVyaWFQcmltYSIsImV4Y2x1aXJNYXRlcmlhUHJpbWEiLCJldiIsImNvbmZpcm0iLCJwYXJlbnQiLCJlbGVtZW50IiwiZG9jdW1lbnQiLCJib2R5IiwidGl0bGUiLCJza3VDb2RlIiwiY29udGVudCIsIm5hbWUiLCJhcmlhTGFiZWwiLCJvayIsImNhbmNlbCIsInRhcmdldEV2ZW50IiwidGhlbiIsImV4Y2x1aXIiLCJpIiwibGVuZ3RoIiwiaWQiLCJzcGxpY2UiLCJza3UiLCJtZWFzdXJpbmdVbml0IiwiZGVzY3JpcHRpb24iLCJjYWRhc3RyYXJNYXRlcmlhUHJpbWEiLCJjYWRhc3RyYXIiLCJwdXNoIiwib3JkZW5hTWF0ZXJpYVByaW1hIiwiY2FtcG9PcmRlbmNhbyIsInJldmVyc2UiLCJtYXRlcmlhbENhdGVnb3JpZXMiLCJtYXRlcmlhbENhdGVnb3J5U2VydmljZSIsIiRodHRwIiwicG9zdCIsIkFQSV9ST1VURV9DQURBU1RSQVJNQVRFUklBTFBSSU1BIiwiQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEiLCJBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BIiwiYXBpVXJsIiwiYXBwQ29uZmlnIiwiJG1kVGhlbWluZ1Byb3ZpZGVyIiwidGhlbWUiLCJwcmltYXJ5UGFsZXR0ZSIsImRlZmF1bHQiLCJodWUtMSIsImh1ZS0yIiwiaHVlLTMiLCJhY2NlbnRQYWxldHRlIiwiY29uc3RhbnQiXSwibWFwcGluZ3MiOiJDQUlBLFdBQ0EsWUFDQUEsU0FDQUMsT0FBQSxPQUFBLFlBQUEsZUFBQSxlQUNBQyxRQUFBLGdCQUFBLFNBQUFDLFVDTEEsV0FFQSxZQWNBLFNBQUFDLEdBQUFDLEdBaUJBLFFBQUFDLEdBQUFDLEdBQ0FDLEtBQUFDLFFBQUFGLEVBQ0FGLEVBQUFLLE1BRUFDLFdBQUEsa0JBQ0FDLGFBQUEsS0FDQUMsWUFBQSxxREFDQUMsT0FBQSxLQUNBQyxpQkFBQSxFQUNBQyxTQUFBLFlBQ0FDLFVBQUEsTUFLQSxRQUFBQyxHQUFBWCxHQUNBQyxLQUFBQyxRQUFBRixFQUNBRixFQUFBSyxNQUVBQyxX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QXRCLFlBQUFBLEVBR0EsT0FBQXhCLEdBbkJBbkIsUUFDQUMsT0FBQSxPQUNBc0IsUUFBQSxzQkFBQVcsR0FFQUEsRUFBQVYsU0FBQSxRQUFBLFFBQUEsZ0JDVkEsV0FFQSxZQWVBLFNBQUErRCxHQUFBQyxHQUNBQSxFQUFBQyxNQUFBLFdBQ0FDLGVBQUEsVUFDQUMsVUFBQSxNQUNBQyxRQUFBLE1BQ0FDLFFBQUEsTUFDQUMsUUFBQSxTQUlBQyxjQUFBLFVBQ0FKLFVBQUEsUUF4QkEsR0FBQTVELEdBQUEsR0FDQXVELEVBQUEsaURBRUF0RixTQUNBQyxPQUFBLE9BQ0ErRixTQUFBLFNBQ0FqRSxXQUFBQSxFQUNBdUQsT0FBQUEsSUFFQXBGLE9BQUFxRixHQUVBQSxFQUFBL0QsU0FBQSxxQkFBQSIsImZpbGUiOiJhcHAuY29uZmFyby5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBqZXN1cyBvbiAxMC8wNS8yMDE2LlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnLFsndWkucm91dGVyJywndG9hc3RTZXJ2aWNlJywnbmdNYXRlcmlhbCddKVxyXG4gICAgICAgIC5jb25maWcoZnVuY3Rpb24oJGh0dHBQcm92aWRlcikge1xyXG4gICAgICAgICAgICAvKiRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ0F1dGhJbnRlcmNlcHRvcicpOyovXHJcbiAgICAgICAgfSlcclxuXHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgSk9TRVZBTERFUkxFSSBvbiAyNy8wNi8yMDE1LlxyXG4gKi9cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCd0b2FzdFNlcnZpY2UnLFtdKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCd0b2FzdENvbnRyb2xsZXInLCBmdW5jdGlvbigkbWRUb2FzdCx0b2FzdEFwcCkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHNlbGYubWVzc2FnZSA9ICB0b2FzdEFwcC5tZXNzYWdlO1xyXG4gICAgICAgICAgICBzZWxmLmNsb3NlVG9hc3QgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRtZFRvYXN0LmhpZGUoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5mYWN0b3J5KCAndG9hc3RBcHAnLCB0b2FzdEFwcCApO1xyXG5cclxuICAgIHRvYXN0QXBwLiRpbmplY3QgPSBbICckbWRUb2FzdCcgXTtcclxuXHJcbiAgICBmdW5jdGlvbiB0b2FzdEFwcCAoJG1kVG9hc3QpIHtcclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgbWVzc2FnZTogJycsXHJcbiAgICAgICAgICAgIG5ld21lc3NhZ2U6IG5ld21lc3NhZ2UsXHJcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZUJvdHRvbTogZXJyb3JNZXNzYWdlQm90dG9tXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgLypmdW5jdGlvbiBlcnJvck1lc3NhZ2UoZXJyb3JNZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxyXG4gICAgICAgICAgICAgICAgLnRleHRDb250ZW50KGVycm9yTWVzc2FnZSlcclxuICAgICAgICAgICAgICAgIC5wb3NpdGlvbigndG9wIHJpZ2h0JylcclxuICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoODAwKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBuZXdtZXNzYWdlKGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3RvYXN0Q29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29udHJvbGUtZXN0b3F1ZS13ZWIvY2xpZW50L3ZpZXdzL2Zvcm1zL3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogXCJPS1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodEFjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJ0b3AgcmlnaHRcIixcclxuICAgICAgICAgICAgICAgICAgICBoaWRlRGVsYXk6IDIwMDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yTWVzc2FnZUJvdHRvbShlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd0b2FzdENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3BhZ2VzL2RzY3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogXCJPS1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodEFjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJib3R0b20gbGVmdFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVEZWxheTogMTAwMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgSk9TRVZBTERFUkxFSSBvbiAyNS8wNi8yMDE1LlxyXG4gKi9cclxuKGZ1bmN0aW9uKCl7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwJylcclxuICAgICAgICAuY29uZmlnKHJvdXRlcyk7XHJcbiAgICBmdW5jdGlvbiByb3V0ZXMoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwgcGF0aHMpIHtcclxuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY2FkYXN0cm9NYXRlcmlhUHJpbWEnLCB7XHJcbiAgICAgICAgICAgIHVybDogJy8nLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogcGF0aHMuc3RhdGljUGF0aCArICd2aWV3cy9mb3Jtcy9jYWRfbWF0ZXJpYXByaW1hLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyIGFzIHZtJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XHJcblxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTAvMDUvMjAxNi5cclxuICovXHJcblxyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwJyxbJ3VpLnJvdXRlcicsJ3RvYXN0U2VydmljZScsJ25nTWF0ZXJpYWwnXSlcclxuICAgICAgICAuY29uZmlnKFtcIiRodHRwUHJvdmlkZXJcIiwgZnVuY3Rpb24oJGh0dHBQcm92aWRlcikge1xyXG4gICAgICAgICAgICAvKiRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ0F1dGhJbnRlcmNlcHRvcicpOyovXHJcbiAgICAgICAgfV0pXHJcblxyXG59KSgpO1xuLyoqXHJcbiAqIENyZWF0ZWQgYnkgSk9TRVZBTERFUkxFSSBvbiAyNy8wNi8yMDE1LlxyXG4gKi9cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCd0b2FzdFNlcnZpY2UnLFtdKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCd0b2FzdENvbnRyb2xsZXInLCBbXCIkbWRUb2FzdFwiLCBcInRvYXN0QXBwXCIsIGZ1bmN0aW9uKCRtZFRvYXN0LHRvYXN0QXBwKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgc2VsZi5tZXNzYWdlID0gIHRvYXN0QXBwLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgIHNlbGYuY2xvc2VUb2FzdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJG1kVG9hc3QuaGlkZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1dKVxyXG4gICAgICAgIC5mYWN0b3J5KCAndG9hc3RBcHAnLCB0b2FzdEFwcCApO1xyXG5cclxuICAgIHRvYXN0QXBwLiRpbmplY3QgPSBbICckbWRUb2FzdCcgXTtcclxuXHJcbiAgICBmdW5jdGlvbiB0b2FzdEFwcCAoJG1kVG9hc3QpIHtcclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgbWVzc2FnZTogJycsXHJcbiAgICAgICAgICAgIG5ld21lc3NhZ2U6IG5ld21lc3NhZ2UsXHJcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZUJvdHRvbTogZXJyb3JNZXNzYWdlQm90dG9tXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgLypmdW5jdGlvbiBlcnJvck1lc3NhZ2UoZXJyb3JNZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxyXG4gICAgICAgICAgICAgICAgLnRleHRDb250ZW50KGVycm9yTWVzc2FnZSlcclxuICAgICAgICAgICAgICAgIC5wb3NpdGlvbigndG9wIHJpZ2h0JylcclxuICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoODAwKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBuZXdtZXNzYWdlKGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3RvYXN0Q29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29udHJvbGUtZXN0b3F1ZS13ZWIvY2xpZW50L3ZpZXdzL2Zvcm1zL3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogXCJPS1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodEFjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJ0b3AgcmlnaHRcIixcclxuICAgICAgICAgICAgICAgICAgICBoaWRlRGVsYXk6IDIwMDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yTWVzc2FnZUJvdHRvbShlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd0b2FzdENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3BhZ2VzL2RzY3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogXCJPS1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodEFjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJib3R0b20gbGVmdFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVEZWxheTogMTAwMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXG4vKipcclxuICogQ3JlYXRlZCBieSBKT1NFVkFMREVSTEVJIG9uIDI1LzA2LzIwMTUuXHJcbiAqL1xyXG4oZnVuY3Rpb24oKXtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5jb25maWcocm91dGVzKTtcclxuICAgIGZ1bmN0aW9uIHJvdXRlcygkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyLCBwYXRocykge1xyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjYWRhc3Ryb01hdGVyaWFQcmltYScsIHtcclxuICAgICAgICAgICAgdXJsOiAnLycsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBwYXRocy5zdGF0aWNQYXRoICsgJ3ZpZXdzL2Zvcm1zL2NhZF9tYXRlcmlhcHJpbWEuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIgYXMgdm0nXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcclxuXHJcbiAgICB9XHJcbiAgICByb3V0ZXMuJGluamVjdCA9IFtcIiRzdGF0ZVByb3ZpZGVyXCIsIFwiJHVybFJvdXRlclByb3ZpZGVyXCIsIFwicGF0aHNcIl07XHJcblxyXG59KSgpO1xyXG5cbi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDEwLzA1LzIwMTYuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgICAgIC5jb250cm9sbGVyKCdjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXInLCBjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlcih0b2FzdEFwcCwgbWF0ZXJpYVByaW1hU2VydmljZSwgJG1kRGlhbG9nKSB7XHJcblxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLmluaXRjYWRhc3Ryb01hdGVyaWFQcmltYSA9IGluaXRjYWRhc3Ryb01hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmNhZGFzdHJhck1hdGVyaWFQcmltYSA9IGNhZGFzdHJhck1hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEgPSBidXNjYVVuaWRhZGVzTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuZXhjbHVpck1hdGVyaWFQcmltYSA9IGV4Y2x1aXJNYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgc2VsZi5saXN0YVVuaWRhZGVzO1xyXG4gICAgICAgIHNlbGYuaXNCdG5SZW1vdmVNYXRlcmlhUHJpbWEgPSBmYWxzZTtcclxuICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHt9O1xyXG4gICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEgPSBbXTtcclxuICAgICAgICBzZWxmLnNlbGVjaW9uYXJNYXRlcmlhUHJpbWEgPSBzZWxlY2lvbmFyTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuY2FtcG9PcmRlbmNhbyA9ICdub21lJztcclxuICAgICAgICBzZWxmLnJldmVyc2UgPSB0cnVlO1xyXG4gICAgICAgIHNlbGYub3JkZW5hTWF0ZXJpYVByaW1hID0gb3JkZW5hTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYubWF0ZXJpYWxDYXRlZ29yaWVzID0gW107XHJcblxyXG5cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYnVzY2FVbmlkYWRlc01hdGVyaWFQcmltYSgpIHtcclxuICAgICAgICAgICAgc2VsZi5saXN0YVVuaWRhZGVzID0gWydLZycsICdtJ11cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjaW9uYXJNYXRlcmlhUHJpbWEobWF0ZXJpYVByaW1hKSB7XHJcbiAgICAgICAgICAgIHNlbGYubWF0ZXJpYXByaW1hID0gbWF0ZXJpYVByaW1hO1xyXG4gICAgICAgICAgICBzZWxmLmlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpbml0Y2FkYXN0cm9NYXRlcmlhUHJpbWEoKSB7XHJcbiAgICAgICAgICAgIG1hdGVyaWFQcmltYVNlcnZpY2UubGlzdGFyVG9kYXMoKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hID0gZGF0YTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAgICAgLyogIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IDEsIG5vbWU6IFwiWCBUZWNpZG9cIiwgc2t1OiBcIjAwMDAwWDk5OVwiLCB1bmlkYWRlOiBcIktHXCIsIG9ic2VydmFjYW86IFwiVGVzdGUgZGUgWFwifTtcclxuICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhcHJpbWEpO1xyXG4gICAgICAgICAgICAgdmFyIG1hdGVyaWFwcmltYSA9IHtpZDogMiwgbm9tZTogXCJCIFRlY2lkb1wiLCBza3U6IFwiMDAwMDBCMDAzXCIsIHVuaWRhZGU6IFwiS0dcIiwgb2JzZXJ2YWNhbzogXCJUZXN0ZSBkZSBCXCJ9O1xyXG4gICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiAgICAgICAgICAgICB2YXIgbWF0ZXJpYXByaW1hID0ge2lkOiAzLCBub21lOiBcIkEgVGVjaWRvXCIsIHNrdTogXCIwMDAwMFg5OTlcIiwgdW5pZGFkZTogXCJLR1wiLCBvYnNlcnZhY2FvOiBcIlRlc3RlIGRlIEFcIn07XHJcbiAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2gobWF0ZXJpYXByaW1hKTtcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXhjbHVpck1hdGVyaWFQcmltYShldiwgbWF0ZXJpYVByaW1hKSB7XHJcbiAgICAgICAgICAgIHZhciBjb25maXJtID0gJG1kRGlhbG9nLmNvbmZpcm0oKVxyXG4gICAgICAgICAgICAgICAgICAgIC5wYXJlbnQoYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpKVxyXG4gICAgICAgICAgICAgICAgICAgIC50aXRsZSgnRXhjbHVpciBNYXTDqXJpYSBwcmltYSBjb20gU2t1JyArIG1hdGVyaWFQcmltYS5za3VDb2RlKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jb250ZW50KCdNYXRlcmlhIFByaW1hOiAnICsgbWF0ZXJpYVByaW1hLm5hbWUpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFyaWFMYWJlbCgnRXhjbHVpciBNYXRlcmlhIFByaW1hJylcclxuICAgICAgICAgICAgICAgICAgICAub2soJ1NpbScpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNhbmNlbCgnTsOjbycpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRhcmdldEV2ZW50KGV2KTtcclxuICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBtYXRlcmlhUHJpbWFTZXJ2aWNlLmV4Y2x1aXIobWF0ZXJpYVByaW1hKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYubGlzdGFNYXRlcmlhUHJpbWEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYVtpXS5pZCA9PT0gbWF0ZXJpYVByaW1hLmlkO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnUmVtb3ZpZG8gY29tIHN1Y2Vzc28hLicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdQcm9ibGVtYSBhbyBBY2Vzc2FyIG8gc2Vydmlkb3InKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5saXN0YU1hdGVyaWFQcmltYVtpXS5pZCArICcgPT09ICcgKyBtYXRlcmlhUHJpbWEuaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYubGlzdGFNYXRlcmlhUHJpbWFbaV0uaWQgPT09IG1hdGVyaWFQcmltYS5pZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VsZi5pc0J0blJlbW92ZU1hdGVyaWFQcmltYSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnUmVtb3ZpZG8gYSBNYXRlcmlhIFByaW1hIGNvbSBvIFNLVS4nICsgbWF0ZXJpYVByaW1hLnNrdSk7XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZi5tYXRlcmlhcHJpbWEgPSB7aWQ6IG51bGwsIG5hbWU6IFwiXCIsIHNrdUNvZGU6IFwiXCIsIG1lYXN1cmluZ1VuaXQ6IFwiXCIsIGRlc2NyaXB0aW9uOiBcIlwifTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBjYWRhc3RyYXJNYXRlcmlhUHJpbWEobWF0ZXJpYVByaW1hKSB7XHJcblxyXG4gICAgICAgICAgICBtYXRlcmlhUHJpbWFTZXJ2aWNlLmNhZGFzdHJhcihtYXRlcmlhUHJpbWEpXHJcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2gobWF0ZXJpYVByaW1hKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ0NhZGFzdHJvIHJlYWxpemFkbyBjb20gc3VjZXNzbyEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ1Byb2JsZW1hIGFvIEFjZXNzYXIgYSBvIHNlcnZpZG9yJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8qICB2YXIgbWF0ZXJpYXByaW1hID0ge2lkOiBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLmxlbmd0aCsxLCBub21lOiBtYXRlcmlhUHJpbWEubm9tZSwgc2t1OiBtYXRlcmlhUHJpbWEuc2t1LCB1bmlkYWRlOiBtYXRlcmlhUHJpbWEudW5pZGFkZSwgb2JzZXJ2YWNhbzogbWF0ZXJpYVByaW1hLm9ic2VydmFjYW99O1xyXG4gICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiAgICAgICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHtpZDogbnVsbCxub21lOiBcIlwiLCBza3U6IFwiXCIsIHVuaWRhZGU6IFwiXCIsIG9ic2VydmFjYW86IFwiXCJ9O1xyXG4gICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnQ2FkYXN0cm8gcmVhbGl6YWRvIGNvbSBzdWNlc3NvIHBhcmEgbyBTS1UuJyArIG1hdGVyaWFQcmltYS5za3UpO1xyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9yZGVuYU1hdGVyaWFQcmltYShjYW1wb09yZGVuY2FvKSB7XHJcbiAgICAgICAgICAgIHNlbGYucmV2ZXJzZSA9IChzZWxmLmNhbXBvT3JkZW5jYW8gPT09IGNhbXBvT3JkZW5jYW8pID8gIXNlbGYucmV2ZXJzZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICBzZWxmLmNhbXBvT3JkZW5jYW8gPSBjYW1wb09yZGVuY2FvO1xyXG5cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuICAgIGNhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlci4kaW5qZWN0ID0gW1widG9hc3RBcHBcIiwgXCJtYXRlcmlhUHJpbWFTZXJ2aWNlXCIsIFwiJG1kRGlhbG9nXCJdO1xyXG5cclxufSkoKTtcclxuXG4vKipcclxuICogQ3JlYXRlZCBieSBqZXN1cyBvbiAxMS8wNS8yMDE2LlxyXG4gKi9cclxuXHJcblxyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmZhY3RvcnkoJ21hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlJywgbWF0ZXJpYWxDYXRlZ29yeVNlcnZpY2UpO1xyXG5cclxuICAgIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywncGF0aHMnLCckbG9jYXRpb24nXTtcclxuXHJcbiAgICBmdW5jdGlvbiBtYXRlcmlhbENhdGVnb3J5U2VydmljZSgkaHR0cCwgcGF0aHMpIHtcclxuXHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9DQURBU1RSQVJNQVRFUklBTFBSSU1BID0gcGF0aHMuYXBpVXJsICsgJ21hdGVyaWFsY2F0ZWdvcnkvY2FkYXN0cmFyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BID0gcGF0aHMuYXBpVXJsICsgJ21hdGVyaWFsY2F0ZWdvcnkvcmVtb3Zlci8nO1xyXG4gICAgICAgIHZhciBBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BID0gcGF0aHMuYXBpVXJsICsgJ21hdGVyaWFsY2F0ZWdvcnkvbGlzdGFyLyc7XHJcblxyXG5cclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgY2FkYXN0cmFyOiBjYWRhc3RyYXIsXHJcbiAgICAgICAgICAgIGV4Y2x1aXI6IGV4Y2x1aXIsXHJcbiAgICAgICAgICAgIGxpc3RhclRvZGFzOiBsaXN0YXJUb2Rhc1xyXG5cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjYWRhc3RyYXIoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGNsdWlyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGlzdGFyVG9kYXMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuXHJcbn0pKCk7XHJcblxuLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTEvMDUvMjAxNi5cclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5mYWN0b3J5KCdtYXRlcmlhUHJpbWFTZXJ2aWNlJywgbWF0ZXJpYVByaW1hU2VydmljZSk7XHJcblxyXG4gICAgbWF0ZXJpYVByaW1hU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsJ3BhdGhzJywgJyRsb2NhdGlvbiddO1xyXG5cclxuICAgIGZ1bmN0aW9uIG1hdGVyaWFQcmltYVNlcnZpY2UoJGh0dHAsIHBhdGhzKSB7XHJcblxyXG4gICAgICAgIHZhciBBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSA9IHBhdGhzLmFwaVVybCArICdtYXRlcmlhbC9jYWRhc3RyYXIvJztcclxuICAgICAgICB2YXIgQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEgPSBwYXRocy5hcGlVcmwgKyAnbWF0ZXJpYWwvcmVtb3Zlci8nO1xyXG4gICAgICAgIHZhciBBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BID0gcGF0aHMuYXBpVXJsICsgJ21hdGVyaWFsL2xpc3Rhci8nO1xyXG5cclxuXHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIGNhZGFzdHJhcjogY2FkYXN0cmFyLFxyXG4gICAgICAgICAgICBleGNsdWlyOiBleGNsdWlyLFxyXG4gICAgICAgICAgICBsaXN0YXJUb2RhczogbGlzdGFyVG9kYXNcclxuXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2FkYXN0cmFyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0NBREFTVFJBUk1BVEVSSUFMUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXhjbHVpcihkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RhclRvZGFzKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcblxyXG59KSgpO1xyXG5cbi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDA2LzA1LzIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgdmFyIHN0YXRpY1BhdGggPSAnJztcclxuICAgIHZhciBhcGlVcmwgPSAnaHR0cDovL2xvY2FsaG9zdDo4MDgwL2NvbnRyb2xlLWVzdG9xdWUtd2ViL2FwaS8nO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5jb25zdGFudCgncGF0aHMnLCB7XHJcbiAgICAgICAgICBzdGF0aWNQYXRoOiBzdGF0aWNQYXRoLFxyXG4gICAgICAgICAgYXBpVXJsOiBhcGlVcmxcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jb25maWcoYXBwQ29uZmlnKTtcclxuXHJcbiAgICBhcHBDb25maWcuJGluamVjdCA9IFsnJG1kVGhlbWluZ1Byb3ZpZGVyJywnJGxvY2F0aW9uUHJvdmlkZXInXTtcclxuXHJcbiAgICBmdW5jdGlvbiBhcHBDb25maWcoJG1kVGhlbWluZ1Byb3ZpZGVyKSB7XHJcbiAgICAgICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcclxuICAgICAgICAgICAgLnByaW1hcnlQYWxldHRlKCdwdXJwbGUnLCB7XHJcbiAgICAgICAgICAgICAgICAnZGVmYXVsdCc6ICc0MDAnLCAvLyBieSBkZWZhdWx0IHVzZSBzaGFkZSA0MDAgZnJvbSB0aGUgcGluayBwYWxldHRlIGZvciBwcmltYXJ5IGludGVudGlvbnNcclxuICAgICAgICAgICAgICAgICdodWUtMSc6ICcxMDAnLCAvLyB1c2Ugc2hhZGUgMTAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTE8L2NvZGU+IGNsYXNzXHJcbiAgICAgICAgICAgICAgICAnaHVlLTInOiAnNjAwJywgLy8gdXNlIHNoYWRlIDYwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0yPC9jb2RlPiBjbGFzc1xyXG4gICAgICAgICAgICAgICAgJ2h1ZS0zJzogJ0ExMDAnIC8vIHVzZSBzaGFkZSBBMTAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTM8L2NvZGU+IGNsYXNzXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC8vIElmIHlvdSBzcGVjaWZ5IGxlc3MgdGhhbiBhbGwgb2YgdGhlIGtleXMsIGl0IHdpbGwgaW5oZXJpdCBmcm9tIHRoZVxyXG4gICAgICAgICAgICAvLyBkZWZhdWx0IHNoYWRlc1xyXG4gICAgICAgICAgICAuYWNjZW50UGFsZXR0ZSgncHVycGxlJywge1xyXG4gICAgICAgICAgICAgICAgJ2RlZmF1bHQnOiAnMjAwJyAvLyB1c2Ugc2hhZGUgMjAwIGZvciBkZWZhdWx0LCBhbmQga2VlcCBhbGwgb3RoZXIgc2hhZGVzIHRoZSBzYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG59KSgpO1xyXG4iLCIvKipcclxuICogQ3JlYXRlZCBieSBqZXN1cyBvbiAxMC8wNS8yMDE2LlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgICAgICAuY29udHJvbGxlcignY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyJywgY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIodG9hc3RBcHAsIG1hdGVyaWFQcmltYVNlcnZpY2UsICRtZERpYWxvZykge1xyXG5cclxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgc2VsZi5pbml0Y2FkYXN0cm9NYXRlcmlhUHJpbWEgPSBpbml0Y2FkYXN0cm9NYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgc2VsZi5jYWRhc3RyYXJNYXRlcmlhUHJpbWEgPSBjYWRhc3RyYXJNYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgc2VsZi5idXNjYVVuaWRhZGVzTWF0ZXJpYVByaW1hID0gYnVzY2FVbmlkYWRlc01hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmV4Y2x1aXJNYXRlcmlhUHJpbWEgPSBleGNsdWlyTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYubGlzdGFVbmlkYWRlcztcclxuICAgICAgICBzZWxmLmlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hID0gZmFsc2U7XHJcbiAgICAgICAgc2VsZi5tYXRlcmlhcHJpbWEgPSB7fTtcclxuICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hID0gW107XHJcbiAgICAgICAgc2VsZi5zZWxlY2lvbmFyTWF0ZXJpYVByaW1hID0gc2VsZWNpb25hck1hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmNhbXBvT3JkZW5jYW8gPSAnbm9tZSc7XHJcbiAgICAgICAgc2VsZi5yZXZlcnNlID0gdHJ1ZTtcclxuICAgICAgICBzZWxmLm9yZGVuYU1hdGVyaWFQcmltYSA9IG9yZGVuYU1hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLm1hdGVyaWFsQ2F0ZWdvcmllcyA9IFtdO1xyXG5cclxuXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEoKSB7XHJcbiAgICAgICAgICAgIHNlbGYubGlzdGFVbmlkYWRlcyA9IFsnS2cnLCAnbSddXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZWxlY2lvbmFyTWF0ZXJpYVByaW1hKG1hdGVyaWFQcmltYSkge1xyXG4gICAgICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IG1hdGVyaWFQcmltYTtcclxuICAgICAgICAgICAgc2VsZi5pc0J0blJlbW92ZU1hdGVyaWFQcmltYSA9IHRydWU7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaW5pdGNhZGFzdHJvTWF0ZXJpYVByaW1hKCkge1xyXG4gICAgICAgICAgICBtYXRlcmlhUHJpbWFTZXJ2aWNlLmxpc3RhclRvZGFzKClcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYSA9IGRhdGE7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgICAgIC8qICB2YXIgbWF0ZXJpYXByaW1hID0ge2lkOiAxLCBub21lOiBcIlggVGVjaWRvXCIsIHNrdTogXCIwMDAwMFg5OTlcIiwgdW5pZGFkZTogXCJLR1wiLCBvYnNlcnZhY2FvOiBcIlRlc3RlIGRlIFhcIn07XHJcbiAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2gobWF0ZXJpYXByaW1hKTtcclxuICAgICAgICAgICAgIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IDIsIG5vbWU6IFwiQiBUZWNpZG9cIiwgc2t1OiBcIjAwMDAwQjAwM1wiLCB1bmlkYWRlOiBcIktHXCIsIG9ic2VydmFjYW86IFwiVGVzdGUgZGUgQlwifTtcclxuICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhcHJpbWEpO1xyXG4gICAgICAgICAgICAgdmFyIG1hdGVyaWFwcmltYSA9IHtpZDogMywgbm9tZTogXCJBIFRlY2lkb1wiLCBza3U6IFwiMDAwMDBYOTk5XCIsIHVuaWRhZGU6IFwiS0dcIiwgb2JzZXJ2YWNhbzogXCJUZXN0ZSBkZSBBXCJ9O1xyXG4gICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGV4Y2x1aXJNYXRlcmlhUHJpbWEoZXYsIG1hdGVyaWFQcmltYSkge1xyXG4gICAgICAgICAgICB2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcclxuICAgICAgICAgICAgICAgICAgICAucGFyZW50KGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSlcclxuICAgICAgICAgICAgICAgICAgICAudGl0bGUoJ0V4Y2x1aXIgTWF0w6lyaWEgcHJpbWEgY29tIFNrdScgKyBtYXRlcmlhUHJpbWEuc2t1Q29kZSlcclxuICAgICAgICAgICAgICAgICAgICAuY29udGVudCgnTWF0ZXJpYSBQcmltYTogJyArIG1hdGVyaWFQcmltYS5uYW1lKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hcmlhTGFiZWwoJ0V4Y2x1aXIgTWF0ZXJpYSBQcmltYScpXHJcbiAgICAgICAgICAgICAgICAgICAgLm9rKCdTaW0nKVxyXG4gICAgICAgICAgICAgICAgICAgIC5jYW5jZWwoJ07Do28nKVxyXG4gICAgICAgICAgICAgICAgICAgIC50YXJnZXRFdmVudChldik7XHJcbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KGNvbmZpcm0pLnRoZW4oZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgbWF0ZXJpYVByaW1hU2VydmljZS5leGNsdWlyKG1hdGVyaWFQcmltYSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWFbaV0uaWQgPT09IG1hdGVyaWFQcmltYS5pZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ1JlbW92aWRvIGNvbSBzdWNlc3NvIS4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnUHJvYmxlbWEgYW8gQWNlc3NhciBvIHNlcnZpZG9yJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYubGlzdGFNYXRlcmlhUHJpbWFbaV0uaWQgKyAnID09PSAnICsgbWF0ZXJpYVByaW1hLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmxpc3RhTWF0ZXJpYVByaW1hW2ldLmlkID09PSBtYXRlcmlhUHJpbWEuaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5zcGxpY2UoaSwgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlbGYuaXNCdG5SZW1vdmVNYXRlcmlhUHJpbWEgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ1JlbW92aWRvIGEgTWF0ZXJpYSBQcmltYSBjb20gbyBTS1UuJyArIG1hdGVyaWFQcmltYS5za3UpO1xyXG5cclxuICAgICAgICAgICAgICAgIHNlbGYubWF0ZXJpYXByaW1hID0ge2lkOiBudWxsLCBuYW1lOiBcIlwiLCBza3VDb2RlOiBcIlwiLCBtZWFzdXJpbmdVbml0OiBcIlwiLCBkZXNjcmlwdGlvbjogXCJcIn07XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gY2FkYXN0cmFyTWF0ZXJpYVByaW1hKG1hdGVyaWFQcmltYSkge1xyXG5cclxuICAgICAgICAgICAgbWF0ZXJpYVByaW1hU2VydmljZS5jYWRhc3RyYXIobWF0ZXJpYVByaW1hKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFQcmltYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdDYWRhc3RybyByZWFsaXphZG8gY29tIHN1Y2Vzc28hJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdQcm9ibGVtYSBhbyBBY2Vzc2FyIGEgbyBzZXJ2aWRvcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvKiAgdmFyIG1hdGVyaWFwcmltYSA9IHtpZDogc2VsZi5saXN0YU1hdGVyaWFQcmltYS5sZW5ndGgrMSwgbm9tZTogbWF0ZXJpYVByaW1hLm5vbWUsIHNrdTogbWF0ZXJpYVByaW1hLnNrdSwgdW5pZGFkZTogbWF0ZXJpYVByaW1hLnVuaWRhZGUsIG9ic2VydmFjYW86IG1hdGVyaWFQcmltYS5vYnNlcnZhY2FvfTtcclxuICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhcHJpbWEpO1xyXG4gICAgICAgICAgICAgc2VsZi5tYXRlcmlhcHJpbWEgPSB7aWQ6IG51bGwsbm9tZTogXCJcIiwgc2t1OiBcIlwiLCB1bmlkYWRlOiBcIlwiLCBvYnNlcnZhY2FvOiBcIlwifTtcclxuICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ0NhZGFzdHJvIHJlYWxpemFkbyBjb20gc3VjZXNzbyBwYXJhIG8gU0tVLicgKyBtYXRlcmlhUHJpbWEuc2t1KTtcclxuICAgICAgICAgICAgICovXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvcmRlbmFNYXRlcmlhUHJpbWEoY2FtcG9PcmRlbmNhbykge1xyXG4gICAgICAgICAgICBzZWxmLnJldmVyc2UgPSAoc2VsZi5jYW1wb09yZGVuY2FvID09PSBjYW1wb09yZGVuY2FvKSA/ICFzZWxmLnJldmVyc2UgOiBmYWxzZTtcclxuICAgICAgICAgICAgc2VsZi5jYW1wb09yZGVuY2FvID0gY2FtcG9PcmRlbmNhbztcclxuXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIvKipcclxuICogQ3JlYXRlZCBieSBqZXN1cyBvbiAxMS8wNS8yMDE2LlxyXG4gKi9cclxuXHJcblxyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmZhY3RvcnkoJ21hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlJywgbWF0ZXJpYWxDYXRlZ29yeVNlcnZpY2UpO1xyXG5cclxuICAgIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywncGF0aHMnLCckbG9jYXRpb24nXTtcclxuXHJcbiAgICBmdW5jdGlvbiBtYXRlcmlhbENhdGVnb3J5U2VydmljZSgkaHR0cCwgcGF0aHMpIHtcclxuXHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9DQURBU1RSQVJNQVRFUklBTFBSSU1BID0gcGF0aHMuYXBpVXJsICsgJ21hdGVyaWFsY2F0ZWdvcnkvY2FkYXN0cmFyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BID0gcGF0aHMuYXBpVXJsICsgJ21hdGVyaWFsY2F0ZWdvcnkvcmVtb3Zlci8nO1xyXG4gICAgICAgIHZhciBBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BID0gcGF0aHMuYXBpVXJsICsgJ21hdGVyaWFsY2F0ZWdvcnkvbGlzdGFyLyc7XHJcblxyXG5cclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgY2FkYXN0cmFyOiBjYWRhc3RyYXIsXHJcbiAgICAgICAgICAgIGV4Y2x1aXI6IGV4Y2x1aXIsXHJcbiAgICAgICAgICAgIGxpc3RhclRvZGFzOiBsaXN0YXJUb2Rhc1xyXG5cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjYWRhc3RyYXIoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGNsdWlyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGlzdGFyVG9kYXMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuXHJcbn0pKCk7XHJcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDExLzA1LzIwMTYuXHJcbiAqL1xyXG5cclxuXHJcbihmdW5jdGlvbigpe1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwJylcclxuICAgICAgICAuZmFjdG9yeSgnbWF0ZXJpYVByaW1hU2VydmljZScsIG1hdGVyaWFQcmltYVNlcnZpY2UpO1xyXG5cclxuICAgIG1hdGVyaWFQcmltYVNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCdwYXRocycsICckbG9jYXRpb24nXTtcclxuXHJcbiAgICBmdW5jdGlvbiBtYXRlcmlhUHJpbWFTZXJ2aWNlKCRodHRwLCBwYXRocykge1xyXG5cclxuICAgICAgICB2YXIgQVBJX1JPVVRFX0NBREFTVFJBUk1BVEVSSUFMUFJJTUEgPSBwYXRocy5hcGlVcmwgKyAnbWF0ZXJpYWwvY2FkYXN0cmFyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BID0gcGF0aHMuYXBpVXJsICsgJ21hdGVyaWFsL3JlbW92ZXIvJztcclxuICAgICAgICB2YXIgQVBJX1JPVVRFX0xJU1RBUk1BVEVSSUFQUklNQSA9IHBhdGhzLmFwaVVybCArICdtYXRlcmlhbC9saXN0YXIvJztcclxuXHJcblxyXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgICBjYWRhc3RyYXI6IGNhZGFzdHJhcixcclxuICAgICAgICAgICAgZXhjbHVpcjogZXhjbHVpcixcclxuICAgICAgICAgICAgbGlzdGFyVG9kYXM6IGxpc3RhclRvZGFzXHJcblxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNhZGFzdHJhcihkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9DQURBU1RSQVJNQVRFUklBTFBSSU1BLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGV4Y2x1aXIoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfRVhDTFVJUk1BVEVSSUFQUklNQSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBsaXN0YXJUb2RhcygpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0xJU1RBUk1BVEVSSUFQUklNQSk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICB9XHJcblxyXG5cclxufSkoKTtcclxuIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMDYvMDUvMjAxNi5cclxuICovXHJcbihmdW5jdGlvbigpe1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICB2YXIgc3RhdGljUGF0aCA9ICcnO1xyXG4gICAgdmFyIGFwaVVybCA9ICdodHRwOi8vbG9jYWxob3N0OjgwODAvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpLyc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmNvbnN0YW50KCdwYXRocycsIHtcclxuICAgICAgICAgIHN0YXRpY1BhdGg6IHN0YXRpY1BhdGgsXHJcbiAgICAgICAgICBhcGlVcmw6IGFwaVVybFxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmNvbmZpZyhhcHBDb25maWcpO1xyXG5cclxuICAgIGFwcENvbmZpZy4kaW5qZWN0ID0gWyckbWRUaGVtaW5nUHJvdmlkZXInLCckbG9jYXRpb25Qcm92aWRlciddO1xyXG5cclxuICAgIGZ1bmN0aW9uIGFwcENvbmZpZygkbWRUaGVtaW5nUHJvdmlkZXIpIHtcclxuICAgICAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxyXG4gICAgICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ3B1cnBsZScsIHtcclxuICAgICAgICAgICAgICAgICdkZWZhdWx0JzogJzQwMCcsIC8vIGJ5IGRlZmF1bHQgdXNlIHNoYWRlIDQwMCBmcm9tIHRoZSBwaW5rIHBhbGV0dGUgZm9yIHByaW1hcnkgaW50ZW50aW9uc1xyXG4gICAgICAgICAgICAgICAgJ2h1ZS0xJzogJzEwMCcsIC8vIHVzZSBzaGFkZSAxMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMTwvY29kZT4gY2xhc3NcclxuICAgICAgICAgICAgICAgICdodWUtMic6ICc2MDAnLCAvLyB1c2Ugc2hhZGUgNjAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTI8L2NvZGU+IGNsYXNzXHJcbiAgICAgICAgICAgICAgICAnaHVlLTMnOiAnQTEwMCcgLy8gdXNlIHNoYWRlIEExMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMzwvY29kZT4gY2xhc3NcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8gSWYgeW91IHNwZWNpZnkgbGVzcyB0aGFuIGFsbCBvZiB0aGUga2V5cywgaXQgd2lsbCBpbmhlcml0IGZyb20gdGhlXHJcbiAgICAgICAgICAgIC8vIGRlZmF1bHQgc2hhZGVzXHJcbiAgICAgICAgICAgIC5hY2NlbnRQYWxldHRlKCdwdXJwbGUnLCB7XHJcbiAgICAgICAgICAgICAgICAnZGVmYXVsdCc6ICcyMDAnIC8vIHVzZSBzaGFkZSAyMDAgZm9yIGRlZmF1bHQsIGFuZCBrZWVwIGFsbCBvdGhlciBzaGFkZXMgdGhlIHNhbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbn0pKCk7XHJcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
