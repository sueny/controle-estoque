!function(){"use strict";angular.module("app",["ui.router","toastService","ngMaterial"]).config(["$httpProvider",function(a){}])}(),function(){"use strict";function a(a){function e(e){this.message=e,a.show({controller:"toastController",controllerAs:"vm",templateUrl:"controle-estoque-web/client/views/forms/toast.html",action:"OK",highlightAction:!0,position:"top right",hideDelay:2e3})}function t(e){this.message=e,a.show({controller:"toastController",controllerAs:"vm",templateUrl:"views/pages/dsctoast.html",action:"OK",highlightAction:!0,position:"bottom left",hideDelay:1e3})}var r={message:"",newmessage:e,errorMessageBottom:t};return r}angular.module("toastService",[]).controller("toastController",["$mdToast","toastApp",function(a,e){var t=this;t.message=e.message,t.closeToast=function(){a.hide()}}]).factory("toastApp",a),a.$inject=["$mdToast"]}(),function(){"use strict";function a(a,e){a.state("cadastroMateriaPrima",{url:"/",templateUrl:"controle-estoque-web/client/views/forms/cad_materiaprima.html",controller:"cadastroMateriaPrimaController as vm"}),e.otherwise("/")}angular.module("app").config(a),a.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function a(a,e,t){function r(){l.listaUnidades=["Kg","m"]}function i(a){l.materiaprima=a,l.isBtnRemoveMateriaPrima=!0}function o(){e.listarTodas().success(function(a){console.log(a),l.listaMateriaPrima=a})}function s(r,i){var o=t.confirm().parent(angular.element(document.body)).title("Excluir Matéria prima com Sku"+i.sku).content("Materia Prima: "+i.nome).ariaLabel("Excluir Materia Prima").ok("Sim").cancel("Não").targetEvent(r);t.show(o).then(function(){e.excluir(i).success(function(e){if(e.success){for(var t=0;t<l.listaMateriaPrima.length;t++)l.listaMateriaPrima[t].id===i.id,l.listaMateriaPrima.splice(t,1);a.newmessage("Removido com sucesso!.")}else a.newmessage("Problema ao Acessar o servidor")});for(var t=0;t<l.listaMateriaPrima.length;t++)if(console.log(l.listaMateriaPrima[t].id+" === "+i.id),l.listaMateriaPrima[t].id===i.id){l.listaMateriaPrima.splice(t,1);break}l.isBtnRemoveMateriaPrima=!1,a.newmessage("Removido a Materia Prima com o SKU."+i.sku),l.materiaprima={id:null,name:"",skuCode:"",measuringUnit:"",description:""}})}function n(t){e.cadastrar(t).success(function(e){e.success?(l.listaMateriaPrima.push(e.materialPrima),a.newmessage("Cadastro realizado com sucesso!")):a.newmessage("Problema ao Acessar a o servidor")})}function c(a){l.reverse=l.campoOrdencao===a?!l.reverse:!1,l.campoOrdencao=a}var l=this;l.initcadastroMateriaPrima=o,l.cadastrarMateriaPrima=n,l.buscaUnidadesMateriaPrima=r,l.excluirMateriaPrima=s,l.listaUnidades,l.isBtnRemoveMateriaPrima=!1,l.materiaprima={},l.listaMateriaPrima=[],l.selecionarMateriaPrima=i,l.campoOrdencao="nome",l.reverse=!0,l.ordenaMateriaPrima=c}angular.module("app").controller("cadastroMateriaPrimaController",a),a.$inject=["toastApp","materiaPrimaService","$mdDialog"]}(),function(){"use strict";function a(a){function e(e){return a.post(i,e)}function t(e){return a.post(o,e)}function r(){return a.post(s)}var i="/controle-estoque-web/api/materialcategory/cadastrar/",o="/controle-estoque-web/api/materialcategory/excluir/",s="/controle-estoque-web/api/materialcategory/listar/",n={cadastrar:e,excluir:t,listarTodas:r};return n}angular.module("app").factory("materialCategoryService",a),a.$inject=["$http","$location"]}(),function(){"use strict";function a(a){function e(e){return a.post(i,e)}function t(e){return a.post(o,e)}function r(){return a.post(s)}var i="/controle-estoque-web/api/material/cadastrar/",o="/controle-estoque-web/api/material/excluir/",s="/controle-estoque-web/api/material/listar/",n={cadastrar:e,excluir:t,listarTodas:r};return n}angular.module("app").factory("materiaPrimaService",a),a.$inject=["$http","$location"]}(),function(){"use strict";function a(a){a.theme("default").primaryPalette("purple",{"default":"400","hue-1":"100","hue-2":"600","hue-3":"A100"}).accentPalette("purple",{"default":"200"})}angular.module("app").config(a),a.$inject=["$mdThemingProvider","$locationProvider"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZhcm8uYXBwLmpzIiwidG9hc3Quc2VydmljZS5qcyIsInJvdXRlci5hcHAuanMiLCJhcHAuY29uZmFyby5taW4uanMiLCJjYWRhc3Ryby9jYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIuanMiLCJzZXJ2aWNlL3NlcnZpY2VNYXRlcmlhbENhdGVnb3J5LmpzIiwic2VydmljZS9zZXJ2aWNlTWF0ZXJpYVByaW1hLmpzIiwiYXBwLWNvbmZpZy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsInRvYXN0QXBwIiwiJG1kVG9hc3QiLCJuZXdtZXNzYWdlIiwiZXJyb3JNZXNzYWdlIiwidGhpcyIsIm1lc3NhZ2UiLCJzaG93IiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlVXJsIiwiYWN0aW9uIiwiaGlnaGxpZ2h0QWN0aW9uIiwicG9zaXRpb24iLCJoaWRlRGVsYXkiLCJlcnJvck1lc3NhZ2VCb3R0b20iLCJzZXJ2aWNlIiwic2VsZiIsImNsb3NlVG9hc3QiLCJoaWRlIiwiZmFjdG9yeSIsIiRpbmplY3QiLCJyb3V0ZXMiLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsInN0YXRlIiwidXJsIiwib3RoZXJ3aXNlIiwiY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyIiwibWF0ZXJpYVByaW1hU2VydmljZSIsIiRtZERpYWxvZyIsImJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEiLCJsaXN0YVVuaWRhZGVzIiwic2VsZWNpb25hck1hdGVyaWFQcmltYSIsIm1hdGVyaWFQcmltYSIsIm1hdGVyaWFwcmltYSIsImlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hIiwiaW5pdGNhZGFzdHJvTWF0ZXJpYVByaW1hIiwibGlzdGFyVG9kYXMiLCJzdWNjZXNzIiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJsaXN0YU1hdGVyaWFQcmltYSIsImV4Y2x1aXJNYXRlcmlhUHJpbWEiLCJldiIsImNvbmZpcm0iLCJwYXJlbnQiLCJlbGVtZW50IiwiZG9jdW1lbnQiLCJib2R5IiwidGl0bGUiLCJza3UiLCJjb250ZW50Iiwibm9tZSIsImFyaWFMYWJlbCIsIm9rIiwiY2FuY2VsIiwidGFyZ2V0RXZlbnQiLCJ0aGVuIiwiZXhjbHVpciIsImkiLCJsZW5ndGgiLCJpZCIsInNwbGljZSIsIm5hbWUiLCJza3VDb2RlIiwibWVhc3VyaW5nVW5pdCIsImRlc2NyaXB0aW9uIiwiY2FkYXN0cmFyTWF0ZXJpYVByaW1hIiwiY2FkYXN0cmFyIiwicHVzaCIsIm1hdGVyaWFsUHJpbWEiLCJvcmRlbmFNYXRlcmlhUHJpbWEiLCJjYW1wb09yZGVuY2FvIiwicmV2ZXJzZSIsIm1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlIiwiJGh0dHAiLCJwb3N0IiwiQVBJX1JPVVRFX0NBREFTVFJBUk1BVEVSSUFMUFJJTUEiLCJBUElfUk9VVEVfRVhDTFVJUk1BVEVSSUFQUklNQSIsIkFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEiLCJhcHBDb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiZGVmYXVsdCIsImh1ZS0xIiwiaHVlLTIiLCJodWUtMyIsImFjY2VudFBhbGV0dGUiXSwibWFwcGluZ3MiOiJDQUlBLFdBQ0EsWUFDQUEsU0FDQUMsT0FBQSxPQUFBLFlBQUEsZUFBQSxlQUNBQyxRQUFBLGdCQUFBLFNBQUFDLFVDTEEsV0FFQSxZQWNBLFNBQUFDLEdBQUFDLEdBaUJBLFFBQUFDLEdBQUFDLEdBQ0FDLEtBQUFDLFFBQUFGLEVBQ0FGLEVBQUFLLE1BRUFDLFdBQUEsa0JBQ0FDLGFBQUEsS0FDQUMsWUFBQSxxREFDQUMsT0FBQSxLQUNBQyxpQkFBQSxFQUNBQyxTQUFBLFlBQ0FDLFVBQUEsTUFLQSxRQUFBQyxHQUFBWCxHQUNBQyxLQUFBQyxRQUFBRixFQUNBRixFQUFBSyxNQUVBQyxXQUFBLGtCQUNBQyxhQUFBLEtBQ0FDLFlBQUEsNEJBQ0FDLE9BQUEs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Y0FBQSxVQUNBSixVQUFBLFFBakJBekYsUUFDQUMsT0FBQSxPQUNBQyxPQUFBbUYsR0FFQUEsRUFBQTdELFNBQUEscUJBQUEiLCJmaWxlIjoiYXBwLmNvbmZhcm8ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTAvMDUvMjAxNi5cclxuICovXHJcblxyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwJyxbJ3VpLnJvdXRlcicsJ3RvYXN0U2VydmljZScsJ25nTWF0ZXJpYWwnXSlcclxuICAgICAgICAuY29uZmlnKGZ1bmN0aW9uKCRodHRwUHJvdmlkZXIpIHtcclxuICAgICAgICAgICAgLyokaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdBdXRoSW50ZXJjZXB0b3InKTsqL1xyXG4gICAgICAgIH0pXHJcblxyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEpPU0VWQUxERVJMRUkgb24gMjcvMDYvMjAxNS5cclxuICovXHJcbihmdW5jdGlvbigpe1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgndG9hc3RTZXJ2aWNlJyxbXSlcclxuICAgICAgICAuY29udHJvbGxlcigndG9hc3RDb250cm9sbGVyJywgZnVuY3Rpb24oJG1kVG9hc3QsdG9hc3RBcHApIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICBzZWxmLm1lc3NhZ2UgPSAgdG9hc3RBcHAubWVzc2FnZTtcclxuICAgICAgICAgICAgc2VsZi5jbG9zZVRvYXN0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5oaWRlKCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZmFjdG9yeSggJ3RvYXN0QXBwJywgdG9hc3RBcHAgKTtcclxuXHJcbiAgICB0b2FzdEFwcC4kaW5qZWN0ID0gWyAnJG1kVG9hc3QnIF07XHJcblxyXG4gICAgZnVuY3Rpb24gdG9hc3RBcHAgKCRtZFRvYXN0KSB7XHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2U6ICcnLFxyXG4gICAgICAgICAgICBuZXdtZXNzYWdlOiBuZXdtZXNzYWdlLFxyXG4gICAgICAgICAgICBlcnJvck1lc3NhZ2VCb3R0b206IGVycm9yTWVzc2FnZUJvdHRvbVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcblxyXG4gICAgICAgIC8qZnVuY3Rpb24gZXJyb3JNZXNzYWdlKGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxyXG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2ltcGxlKClcclxuICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudChlcnJvck1lc3NhZ2UpXHJcbiAgICAgICAgICAgICAgICAucG9zaXRpb24oJ3RvcCByaWdodCcpXHJcbiAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDgwMClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9Ki9cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbmV3bWVzc2FnZShlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd0b2FzdENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbnRyb2xlLWVzdG9xdWUtd2ViL2NsaWVudC92aWV3cy9mb3Jtcy90b2FzdC5odG1sJyxcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IFwiT0tcIixcclxuICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRBY3Rpb246IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFwidG9wIHJpZ2h0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaGlkZURlbGF5OiAyMDAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlcnJvck1lc3NhZ2VCb3R0b20oZXJyb3JNZXNzYWdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IGVycm9yTWVzc2FnZTtcclxuICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAndG9hc3RDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wYWdlcy9kc2N0b2FzdC5odG1sJyxcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IFwiT0tcIixcclxuICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRBY3Rpb246IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFwiYm90dG9tIGxlZnRcIixcclxuICAgICAgICAgICAgICAgICAgICBoaWRlRGVsYXk6IDEwMDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEpPU0VWQUxERVJMRUkgb24gMjUvMDYvMjAxNS5cclxuICovXHJcbihmdW5jdGlvbigpe1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmNvbmZpZyhyb3V0ZXMpO1xyXG4gICAgZnVuY3Rpb24gcm91dGVzKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcclxuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY2FkYXN0cm9NYXRlcmlhUHJpbWEnLCB7XHJcbiAgICAgICAgICAgIHVybDogJy8nLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbnRyb2xlLWVzdG9xdWUtd2ViL2NsaWVudC92aWV3cy9mb3Jtcy9jYWRfbWF0ZXJpYXByaW1hLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyIGFzIHZtJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XHJcblxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTAvMDUvMjAxNi5cclxuICovXHJcblxyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwJyxbJ3VpLnJvdXRlcicsJ3RvYXN0U2VydmljZScsJ25nTWF0ZXJpYWwnXSlcclxuICAgICAgICAuY29uZmlnKFtcIiRodHRwUHJvdmlkZXJcIiwgZnVuY3Rpb24oJGh0dHBQcm92aWRlcikge1xyXG4gICAgICAgICAgICAvKiRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ0F1dGhJbnRlcmNlcHRvcicpOyovXHJcbiAgICAgICAgfV0pXHJcblxyXG59KSgpO1xuLyoqXHJcbiAqIENyZWF0ZWQgYnkgSk9TRVZBTERFUkxFSSBvbiAyNy8wNi8yMDE1LlxyXG4gKi9cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCd0b2FzdFNlcnZpY2UnLFtdKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCd0b2FzdENvbnRyb2xsZXInLCBbXCIkbWRUb2FzdFwiLCBcInRvYXN0QXBwXCIsIGZ1bmN0aW9uKCRtZFRvYXN0LHRvYXN0QXBwKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgc2VsZi5tZXNzYWdlID0gIHRvYXN0QXBwLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgIHNlbGYuY2xvc2VUb2FzdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJG1kVG9hc3QuaGlkZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1dKVxyXG4gICAgICAgIC5mYWN0b3J5KCAndG9hc3RBcHAnLCB0b2FzdEFwcCApO1xyXG5cclxuICAgIHRvYXN0QXBwLiRpbmplY3QgPSBbICckbWRUb2FzdCcgXTtcclxuXHJcbiAgICBmdW5jdGlvbiB0b2FzdEFwcCAoJG1kVG9hc3QpIHtcclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgbWVzc2FnZTogJycsXHJcbiAgICAgICAgICAgIG5ld21lc3NhZ2U6IG5ld21lc3NhZ2UsXHJcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZUJvdHRvbTogZXJyb3JNZXNzYWdlQm90dG9tXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgLypmdW5jdGlvbiBlcnJvck1lc3NhZ2UoZXJyb3JNZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxyXG4gICAgICAgICAgICAgICAgLnRleHRDb250ZW50KGVycm9yTWVzc2FnZSlcclxuICAgICAgICAgICAgICAgIC5wb3NpdGlvbigndG9wIHJpZ2h0JylcclxuICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoODAwKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBuZXdtZXNzYWdlKGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3RvYXN0Q29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29udHJvbGUtZXN0b3F1ZS13ZWIvY2xpZW50L3ZpZXdzL2Zvcm1zL3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogXCJPS1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodEFjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJ0b3AgcmlnaHRcIixcclxuICAgICAgICAgICAgICAgICAgICBoaWRlRGVsYXk6IDIwMDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yTWVzc2FnZUJvdHRvbShlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd0b2FzdENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3BhZ2VzL2RzY3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogXCJPS1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodEFjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJib3R0b20gbGVmdFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVEZWxheTogMTAwMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXG4vKipcclxuICogQ3JlYXRlZCBieSBKT1NFVkFMREVSTEVJIG9uIDI1LzA2LzIwMTUuXHJcbiAqL1xyXG4oZnVuY3Rpb24oKXtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5jb25maWcocm91dGVzKTtcclxuICAgIGZ1bmN0aW9uIHJvdXRlcygkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XHJcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NhZGFzdHJvTWF0ZXJpYVByaW1hJywge1xyXG4gICAgICAgICAgICB1cmw6ICcvJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb250cm9sZS1lc3RvcXVlLXdlYi9jbGllbnQvdmlld3MvZm9ybXMvY2FkX21hdGVyaWFwcmltYS5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlciBhcyB2bSdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xyXG5cclxuICAgIH1cclxuICAgIHJvdXRlcy4kaW5qZWN0ID0gW1wiJHN0YXRlUHJvdmlkZXJcIiwgXCIkdXJsUm91dGVyUHJvdmlkZXJcIl07XHJcblxyXG59KSgpO1xyXG5cbi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDEwLzA1LzIwMTYuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXInLCBjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlcih0b2FzdEFwcCxtYXRlcmlhUHJpbWFTZXJ2aWNlLCRtZERpYWxvZyl7XHJcblxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLmluaXRjYWRhc3Ryb01hdGVyaWFQcmltYSA9IGluaXRjYWRhc3Ryb01hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmNhZGFzdHJhck1hdGVyaWFQcmltYSA9IGNhZGFzdHJhck1hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEgPSBidXNjYVVuaWRhZGVzTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuZXhjbHVpck1hdGVyaWFQcmltYSA9IGV4Y2x1aXJNYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgc2VsZi5saXN0YVVuaWRhZGVzO1xyXG4gICAgICAgIHNlbGYuaXNCdG5SZW1vdmVNYXRlcmlhUHJpbWEgPSBmYWxzZTtcclxuICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHt9O1xyXG4gICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEgPSBbXTtcclxuICAgICAgICBzZWxmLnNlbGVjaW9uYXJNYXRlcmlhUHJpbWEgPSBzZWxlY2lvbmFyTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuY2FtcG9PcmRlbmNhbyA9ICdub21lJztcclxuICAgICAgICBzZWxmLnJldmVyc2UgPSB0cnVlO1xyXG4gICAgICAgIHNlbGYub3JkZW5hTWF0ZXJpYVByaW1hID0gb3JkZW5hTWF0ZXJpYVByaW1hO1xyXG5cclxuXHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBidXNjYVVuaWRhZGVzTWF0ZXJpYVByaW1hKCl7XHJcbiAgICAgICAgICAgIHNlbGYubGlzdGFVbmlkYWRlcyA9IFsnS2cnLCdtJ11cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjaW9uYXJNYXRlcmlhUHJpbWEgKG1hdGVyaWFQcmltYSl7XHJcbiAgICAgICAgICAgIHNlbGYubWF0ZXJpYXByaW1hID0gbWF0ZXJpYVByaW1hO1xyXG4gICAgICAgICAgICBzZWxmLmlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpbml0Y2FkYXN0cm9NYXRlcmlhUHJpbWEoKXtcclxuICAgICAgICAgICAgbWF0ZXJpYVByaW1hU2VydmljZS5saXN0YXJUb2RhcygpXHJcbiAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hID0gZGF0YTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgICAgLyogIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IDEsIG5vbWU6IFwiWCBUZWNpZG9cIiwgc2t1OiBcIjAwMDAwWDk5OVwiLCB1bmlkYWRlOiBcIktHXCIsIG9ic2VydmFjYW86IFwiVGVzdGUgZGUgWFwifTtcclxuICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiAgICAgICAgICAgIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IDIsIG5vbWU6IFwiQiBUZWNpZG9cIiwgc2t1OiBcIjAwMDAwQjAwM1wiLCB1bmlkYWRlOiBcIktHXCIsIG9ic2VydmFjYW86IFwiVGVzdGUgZGUgQlwifTtcclxuICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiAgICAgICAgICAgIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IDMsIG5vbWU6IFwiQSBUZWNpZG9cIiwgc2t1OiBcIjAwMDAwWDk5OVwiLCB1bmlkYWRlOiBcIktHXCIsIG9ic2VydmFjYW86IFwiVGVzdGUgZGUgQVwifTtcclxuICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiovXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXhjbHVpck1hdGVyaWFQcmltYShldixtYXRlcmlhUHJpbWEpe1xyXG4gICAgICAgICAgICB2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcclxuICAgICAgICAgICAgICAgIC5wYXJlbnQoYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpKVxyXG4gICAgICAgICAgICAgICAgLnRpdGxlKCdFeGNsdWlyIE1hdMOpcmlhIHByaW1hIGNvbSBTa3UnICsgbWF0ZXJpYVByaW1hLnNrdSlcclxuICAgICAgICAgICAgICAgIC5jb250ZW50KCdNYXRlcmlhIFByaW1hOiAnICsgbWF0ZXJpYVByaW1hLm5vbWUpXHJcbiAgICAgICAgICAgICAgICAuYXJpYUxhYmVsKCdFeGNsdWlyIE1hdGVyaWEgUHJpbWEnKVxyXG4gICAgICAgICAgICAgICAgLm9rKCdTaW0nKVxyXG4gICAgICAgICAgICAgICAgLmNhbmNlbCgnTsOjbycpXHJcbiAgICAgICAgICAgICAgICAudGFyZ2V0RXZlbnQoZXYpO1xyXG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyhjb25maXJtKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgbWF0ZXJpYVByaW1hU2VydmljZS5leGNsdWlyKG1hdGVyaWFQcmltYSlcclxuICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgaWYoZGF0YS5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7IGkgPCBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hW2ldLmlkID09PSBtYXRlcmlhUHJpbWEuaWQ7XHJcbiAgICAgICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5zcGxpY2UoaSwxKTtcclxuICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnUmVtb3ZpZG8gY29tIHN1Y2Vzc28hLicpO1xyXG4gICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ1Byb2JsZW1hIGFvIEFjZXNzYXIgbyBzZXJ2aWRvcicpO1xyXG4gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDsgaSA8IHNlbGYubGlzdGFNYXRlcmlhUHJpbWEubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYubGlzdGFNYXRlcmlhUHJpbWFbaV0uaWQgKyAnID09PSAnICsgIG1hdGVyaWFQcmltYS5pZClcclxuICAgICAgICAgICAgICAgICAgICBpZihzZWxmLmxpc3RhTWF0ZXJpYVByaW1hW2ldLmlkID09PSBtYXRlcmlhUHJpbWEuaWQpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnNwbGljZShpLDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxmLmlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdSZW1vdmlkbyBhIE1hdGVyaWEgUHJpbWEgY29tIG8gU0tVLicgKyBtYXRlcmlhUHJpbWEuc2t1KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHtpZDogbnVsbCxuYW1lOiBcIlwiLCBza3VDb2RlOiBcIlwiLCBtZWFzdXJpbmdVbml0OiBcIlwiLCBkZXNjcmlwdGlvbjogXCJcIn07XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcbiAgICAgICAgZnVuY3Rpb24gY2FkYXN0cmFyTWF0ZXJpYVByaW1hKG1hdGVyaWFQcmltYSl7XHJcblxyXG4gICAgICAgICAgICAgbWF0ZXJpYVByaW1hU2VydmljZS5jYWRhc3RyYXIobWF0ZXJpYVByaW1hKVxyXG4gICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgaWYoZGF0YS5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2goZGF0YS5tYXRlcmlhbFByaW1hKTtcclxuICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ0NhZGFzdHJvIHJlYWxpemFkbyBjb20gc3VjZXNzbyEnKTtcclxuICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnUHJvYmxlbWEgYW8gQWNlc3NhciBhIG8gc2Vydmlkb3InKTtcclxuICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgIC8qICB2YXIgbWF0ZXJpYXByaW1hID0ge2lkOiBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLmxlbmd0aCsxLCBub21lOiBtYXRlcmlhUHJpbWEubm9tZSwgc2t1OiBtYXRlcmlhUHJpbWEuc2t1LCB1bmlkYWRlOiBtYXRlcmlhUHJpbWEudW5pZGFkZSwgb2JzZXJ2YWNhbzogbWF0ZXJpYVByaW1hLm9ic2VydmFjYW99O1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2gobWF0ZXJpYXByaW1hKTtcclxuICAgICAgICAgICAgc2VsZi5tYXRlcmlhcHJpbWEgPSB7aWQ6IG51bGwsbm9tZTogXCJcIiwgc2t1OiBcIlwiLCB1bmlkYWRlOiBcIlwiLCBvYnNlcnZhY2FvOiBcIlwifTtcclxuICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnQ2FkYXN0cm8gcmVhbGl6YWRvIGNvbSBzdWNlc3NvIHBhcmEgbyBTS1UuJyArIG1hdGVyaWFQcmltYS5za3UpO1xyXG4qL1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb3JkZW5hTWF0ZXJpYVByaW1hKGNhbXBvT3JkZW5jYW8pe1xyXG4gICAgICAgICAgICBzZWxmLnJldmVyc2UgPSAoc2VsZi5jYW1wb09yZGVuY2FvID09PSBjYW1wb09yZGVuY2FvKSA/ICFzZWxmLnJldmVyc2UgOiBmYWxzZTtcclxuICAgICAgICAgICAgc2VsZi5jYW1wb09yZGVuY2FvID0gY2FtcG9PcmRlbmNhbztcclxuXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICB9XHJcbiAgICBjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIuJGluamVjdCA9IFtcInRvYXN0QXBwXCIsIFwibWF0ZXJpYVByaW1hU2VydmljZVwiLCBcIiRtZERpYWxvZ1wiXTtcclxuXHJcbn0pKCk7XG4vKipcclxuICogQ3JlYXRlZCBieSBqZXN1cyBvbiAxMS8wNS8yMDE2LlxyXG4gKi9cclxuXHJcblxyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmZhY3RvcnkoJ21hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlJywgbWF0ZXJpYWxDYXRlZ29yeVNlcnZpY2UpO1xyXG5cclxuICAgIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywnJGxvY2F0aW9uJ107XHJcblxyXG4gICAgZnVuY3Rpb24gbWF0ZXJpYWxDYXRlZ29yeVNlcnZpY2UoJGh0dHApIHtcclxuXHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9DQURBU1RSQVJNQVRFUklBTFBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWxjYXRlZ29yeS9jYWRhc3RyYXIvJztcclxuICAgICAgICB2YXIgQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEgPSAnL2NvbnRyb2xlLWVzdG9xdWUtd2ViL2FwaS9tYXRlcmlhbGNhdGVnb3J5L2V4Y2x1aXIvJztcclxuICAgICAgICB2YXIgQVBJX1JPVVRFX0xJU1RBUk1BVEVSSUFQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsY2F0ZWdvcnkvbGlzdGFyLyc7XHJcblxyXG5cclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgY2FkYXN0cmFyOiBjYWRhc3RyYXIsXHJcbiAgICAgICAgICAgIGV4Y2x1aXI6IGV4Y2x1aXIsXHJcbiAgICAgICAgICAgIGxpc3RhclRvZGFzOiBsaXN0YXJUb2Rhc1xyXG5cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjYWRhc3RyYXIoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGNsdWlyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGlzdGFyVG9kYXMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuXHJcbn0pKCk7XG4vKipcclxuICogQ3JlYXRlZCBieSBqZXN1cyBvbiAxMS8wNS8yMDE2LlxyXG4gKi9cclxuXHJcblxyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmZhY3RvcnkoJ21hdGVyaWFQcmltYVNlcnZpY2UnLCBtYXRlcmlhUHJpbWFTZXJ2aWNlKTtcclxuXHJcbiAgICBtYXRlcmlhUHJpbWFTZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywnJGxvY2F0aW9uJ107XHJcblxyXG4gICAgZnVuY3Rpb24gbWF0ZXJpYVByaW1hU2VydmljZSgkaHR0cCkge1xyXG5cclxuICAgICAgICB2YXIgQVBJX1JPVVRFX0NBREFTVFJBUk1BVEVSSUFMUFJJTUEgPSAnL2NvbnRyb2xlLWVzdG9xdWUtd2ViL2FwaS9tYXRlcmlhbC9jYWRhc3RyYXIvJztcclxuICAgICAgICB2YXIgQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEgPSAnL2NvbnRyb2xlLWVzdG9xdWUtd2ViL2FwaS9tYXRlcmlhbC9leGNsdWlyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEgPSAnL2NvbnRyb2xlLWVzdG9xdWUtd2ViL2FwaS9tYXRlcmlhbC9saXN0YXIvJztcclxuXHJcblxyXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgICBjYWRhc3RyYXI6IGNhZGFzdHJhcixcclxuICAgICAgICAgICAgZXhjbHVpcjogZXhjbHVpcixcclxuICAgICAgICAgICAgbGlzdGFyVG9kYXM6IGxpc3RhclRvZGFzXHJcblxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNhZGFzdHJhcihkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9DQURBU1RSQVJNQVRFUklBTFBSSU1BLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGV4Y2x1aXIoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfRVhDTFVJUk1BVEVSSUFQUklNQSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBsaXN0YXJUb2RhcygpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0xJU1RBUk1BVEVSSUFQUklNQSk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICB9XHJcblxyXG5cclxufSkoKTtcbi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDA2LzA1LzIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmNvbmZpZyhhcHBDb25maWcpO1xyXG5cclxuICAgIGFwcENvbmZpZy4kaW5qZWN0ID0gWyckbWRUaGVtaW5nUHJvdmlkZXInLCckbG9jYXRpb25Qcm92aWRlciddO1xyXG5cclxuICAgIGZ1bmN0aW9uIGFwcENvbmZpZygkbWRUaGVtaW5nUHJvdmlkZXIpIHtcclxuICAgICAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxyXG4gICAgICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ3B1cnBsZScsIHtcclxuICAgICAgICAgICAgICAgICdkZWZhdWx0JzogJzQwMCcsIC8vIGJ5IGRlZmF1bHQgdXNlIHNoYWRlIDQwMCBmcm9tIHRoZSBwaW5rIHBhbGV0dGUgZm9yIHByaW1hcnkgaW50ZW50aW9uc1xyXG4gICAgICAgICAgICAgICAgJ2h1ZS0xJzogJzEwMCcsIC8vIHVzZSBzaGFkZSAxMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMTwvY29kZT4gY2xhc3NcclxuICAgICAgICAgICAgICAgICdodWUtMic6ICc2MDAnLCAvLyB1c2Ugc2hhZGUgNjAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTI8L2NvZGU+IGNsYXNzXHJcbiAgICAgICAgICAgICAgICAnaHVlLTMnOiAnQTEwMCcgLy8gdXNlIHNoYWRlIEExMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMzwvY29kZT4gY2xhc3NcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8gSWYgeW91IHNwZWNpZnkgbGVzcyB0aGFuIGFsbCBvZiB0aGUga2V5cywgaXQgd2lsbCBpbmhlcml0IGZyb20gdGhlXHJcbiAgICAgICAgICAgIC8vIGRlZmF1bHQgc2hhZGVzXHJcbiAgICAgICAgICAgIC5hY2NlbnRQYWxldHRlKCdwdXJwbGUnLCB7XHJcbiAgICAgICAgICAgICAgICAnZGVmYXVsdCc6ICcyMDAnIC8vIHVzZSBzaGFkZSAyMDAgZm9yIGRlZmF1bHQsIGFuZCBrZWVwIGFsbCBvdGhlciBzaGFkZXMgdGhlIHNhbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTAvMDUvMjAxNi5cclxuICovXHJcblxyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ2NhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlcicsIGNhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlcik7XHJcblxyXG4gICAgZnVuY3Rpb24gY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyKHRvYXN0QXBwLG1hdGVyaWFQcmltYVNlcnZpY2UsJG1kRGlhbG9nKXtcclxuXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYuaW5pdGNhZGFzdHJvTWF0ZXJpYVByaW1hID0gaW5pdGNhZGFzdHJvTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuY2FkYXN0cmFyTWF0ZXJpYVByaW1hID0gY2FkYXN0cmFyTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuYnVzY2FVbmlkYWRlc01hdGVyaWFQcmltYSA9IGJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgc2VsZi5leGNsdWlyTWF0ZXJpYVByaW1hID0gZXhjbHVpck1hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmxpc3RhVW5pZGFkZXM7XHJcbiAgICAgICAgc2VsZi5pc0J0blJlbW92ZU1hdGVyaWFQcmltYSA9IGZhbHNlO1xyXG4gICAgICAgIHNlbGYubWF0ZXJpYXByaW1hID0ge307XHJcbiAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYSA9IFtdO1xyXG4gICAgICAgIHNlbGYuc2VsZWNpb25hck1hdGVyaWFQcmltYSA9IHNlbGVjaW9uYXJNYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgc2VsZi5jYW1wb09yZGVuY2FvID0gJ25vbWUnO1xyXG4gICAgICAgIHNlbGYucmV2ZXJzZSA9IHRydWU7XHJcbiAgICAgICAgc2VsZi5vcmRlbmFNYXRlcmlhUHJpbWEgPSBvcmRlbmFNYXRlcmlhUHJpbWE7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEoKXtcclxuICAgICAgICAgICAgc2VsZi5saXN0YVVuaWRhZGVzID0gWydLZycsJ20nXVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2VsZWNpb25hck1hdGVyaWFQcmltYSAobWF0ZXJpYVByaW1hKXtcclxuICAgICAgICAgICAgc2VsZi5tYXRlcmlhcHJpbWEgPSBtYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgICAgIHNlbGYuaXNCdG5SZW1vdmVNYXRlcmlhUHJpbWEgPSB0cnVlO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGluaXRjYWRhc3Ryb01hdGVyaWFQcmltYSgpe1xyXG4gICAgICAgICAgICBtYXRlcmlhUHJpbWFTZXJ2aWNlLmxpc3RhclRvZGFzKClcclxuICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEgPSBkYXRhO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgICAvKiAgdmFyIG1hdGVyaWFwcmltYSA9IHtpZDogMSwgbm9tZTogXCJYIFRlY2lkb1wiLCBza3U6IFwiMDAwMDBYOTk5XCIsIHVuaWRhZGU6IFwiS0dcIiwgb2JzZXJ2YWNhbzogXCJUZXN0ZSBkZSBYXCJ9O1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2gobWF0ZXJpYXByaW1hKTtcclxuICAgICAgICAgICAgdmFyIG1hdGVyaWFwcmltYSA9IHtpZDogMiwgbm9tZTogXCJCIFRlY2lkb1wiLCBza3U6IFwiMDAwMDBCMDAzXCIsIHVuaWRhZGU6IFwiS0dcIiwgb2JzZXJ2YWNhbzogXCJUZXN0ZSBkZSBCXCJ9O1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2gobWF0ZXJpYXByaW1hKTtcclxuICAgICAgICAgICAgdmFyIG1hdGVyaWFwcmltYSA9IHtpZDogMywgbm9tZTogXCJBIFRlY2lkb1wiLCBza3U6IFwiMDAwMDBYOTk5XCIsIHVuaWRhZGU6IFwiS0dcIiwgb2JzZXJ2YWNhbzogXCJUZXN0ZSBkZSBBXCJ9O1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2gobWF0ZXJpYXByaW1hKTtcclxuKi9cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGNsdWlyTWF0ZXJpYVByaW1hKGV2LG1hdGVyaWFQcmltYSl7XHJcbiAgICAgICAgICAgIHZhciBjb25maXJtID0gJG1kRGlhbG9nLmNvbmZpcm0oKVxyXG4gICAgICAgICAgICAgICAgLnBhcmVudChhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkpXHJcbiAgICAgICAgICAgICAgICAudGl0bGUoJ0V4Y2x1aXIgTWF0w6lyaWEgcHJpbWEgY29tIFNrdScgKyBtYXRlcmlhUHJpbWEuc2t1KVxyXG4gICAgICAgICAgICAgICAgLmNvbnRlbnQoJ01hdGVyaWEgUHJpbWE6ICcgKyBtYXRlcmlhUHJpbWEubm9tZSlcclxuICAgICAgICAgICAgICAgIC5hcmlhTGFiZWwoJ0V4Y2x1aXIgTWF0ZXJpYSBQcmltYScpXHJcbiAgICAgICAgICAgICAgICAub2soJ1NpbScpXHJcbiAgICAgICAgICAgICAgICAuY2FuY2VsKCdOw6NvJylcclxuICAgICAgICAgICAgICAgIC50YXJnZXRFdmVudChldik7XHJcbiAgICAgICAgICAgICRtZERpYWxvZy5zaG93KGNvbmZpcm0pLnRoZW4oZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBtYXRlcmlhUHJpbWFTZXJ2aWNlLmV4Y2x1aXIobWF0ZXJpYVByaW1hKVxyXG4gICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICBpZihkYXRhLnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDsgaSA8IHNlbGYubGlzdGFNYXRlcmlhUHJpbWEubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWFbaV0uaWQgPT09IG1hdGVyaWFQcmltYS5pZDtcclxuICAgICAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnNwbGljZShpLDEpO1xyXG4gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdSZW1vdmlkbyBjb20gc3VjZXNzbyEuJyk7XHJcbiAgICAgICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnUHJvYmxlbWEgYW8gQWNlc3NhciBvIHNlcnZpZG9yJyk7XHJcbiAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wOyBpIDwgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5saXN0YU1hdGVyaWFQcmltYVtpXS5pZCArICcgPT09ICcgKyAgbWF0ZXJpYVByaW1hLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgIGlmKHNlbGYubGlzdGFNYXRlcmlhUHJpbWFbaV0uaWQgPT09IG1hdGVyaWFQcmltYS5pZCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEuc3BsaWNlKGksMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHNlbGYuaXNCdG5SZW1vdmVNYXRlcmlhUHJpbWEgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ1JlbW92aWRvIGEgTWF0ZXJpYSBQcmltYSBjb20gbyBTS1UuJyArIG1hdGVyaWFQcmltYS5za3UpO1xyXG5cclxuICAgICAgICAgICAgICAgIHNlbGYubWF0ZXJpYXByaW1hID0ge2lkOiBudWxsLG5hbWU6IFwiXCIsIHNrdUNvZGU6IFwiXCIsIG1lYXN1cmluZ1VuaXQ6IFwiXCIsIGRlc2NyaXB0aW9uOiBcIlwifTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBjYWRhc3RyYXJNYXRlcmlhUHJpbWEobWF0ZXJpYVByaW1hKXtcclxuXHJcbiAgICAgICAgICAgICBtYXRlcmlhUHJpbWFTZXJ2aWNlLmNhZGFzdHJhcihtYXRlcmlhUHJpbWEpXHJcbiAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICBpZihkYXRhLnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChkYXRhLm1hdGVyaWFsUHJpbWEpO1xyXG4gICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnQ2FkYXN0cm8gcmVhbGl6YWRvIGNvbSBzdWNlc3NvIScpO1xyXG4gICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdQcm9ibGVtYSBhbyBBY2Vzc2FyIGEgbyBzZXJ2aWRvcicpO1xyXG4gICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgLyogIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IHNlbGYubGlzdGFNYXRlcmlhUHJpbWEubGVuZ3RoKzEsIG5vbWU6IG1hdGVyaWFQcmltYS5ub21lLCBza3U6IG1hdGVyaWFQcmltYS5za3UsIHVuaWRhZGU6IG1hdGVyaWFQcmltYS51bmlkYWRlLCBvYnNlcnZhY2FvOiBtYXRlcmlhUHJpbWEub2JzZXJ2YWNhb307XHJcbiAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhcHJpbWEpO1xyXG4gICAgICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHtpZDogbnVsbCxub21lOiBcIlwiLCBza3U6IFwiXCIsIHVuaWRhZGU6IFwiXCIsIG9ic2VydmFjYW86IFwiXCJ9O1xyXG4gICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdDYWRhc3RybyByZWFsaXphZG8gY29tIHN1Y2Vzc28gcGFyYSBvIFNLVS4nICsgbWF0ZXJpYVByaW1hLnNrdSk7XHJcbiovXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvcmRlbmFNYXRlcmlhUHJpbWEoY2FtcG9PcmRlbmNhbyl7XHJcbiAgICAgICAgICAgIHNlbGYucmV2ZXJzZSA9IChzZWxmLmNhbXBvT3JkZW5jYW8gPT09IGNhbXBvT3JkZW5jYW8pID8gIXNlbGYucmV2ZXJzZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICBzZWxmLmNhbXBvT3JkZW5jYW8gPSBjYW1wb09yZGVuY2FvO1xyXG5cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTEvMDUvMjAxNi5cclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5mYWN0b3J5KCdtYXRlcmlhbENhdGVnb3J5U2VydmljZScsIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlKTtcclxuXHJcbiAgICBtYXRlcmlhbENhdGVnb3J5U2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsJyRsb2NhdGlvbiddO1xyXG5cclxuICAgIGZ1bmN0aW9uIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlKCRodHRwKSB7XHJcblxyXG4gICAgICAgIHZhciBBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsY2F0ZWdvcnkvY2FkYXN0cmFyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWxjYXRlZ29yeS9leGNsdWlyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEgPSAnL2NvbnRyb2xlLWVzdG9xdWUtd2ViL2FwaS9tYXRlcmlhbGNhdGVnb3J5L2xpc3Rhci8nO1xyXG5cclxuXHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIGNhZGFzdHJhcjogY2FkYXN0cmFyLFxyXG4gICAgICAgICAgICBleGNsdWlyOiBleGNsdWlyLFxyXG4gICAgICAgICAgICBsaXN0YXJUb2RhczogbGlzdGFyVG9kYXNcclxuXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2FkYXN0cmFyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0NBREFTVFJBUk1BVEVSSUFMUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXhjbHVpcihkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RhclRvZGFzKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcblxyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDExLzA1LzIwMTYuXHJcbiAqL1xyXG5cclxuXHJcbihmdW5jdGlvbigpe1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwJylcclxuICAgICAgICAuZmFjdG9yeSgnbWF0ZXJpYVByaW1hU2VydmljZScsIG1hdGVyaWFQcmltYVNlcnZpY2UpO1xyXG5cclxuICAgIG1hdGVyaWFQcmltYVNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCckbG9jYXRpb24nXTtcclxuXHJcbiAgICBmdW5jdGlvbiBtYXRlcmlhUHJpbWFTZXJ2aWNlKCRodHRwKSB7XHJcblxyXG4gICAgICAgIHZhciBBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsL2NhZGFzdHJhci8nO1xyXG4gICAgICAgIHZhciBBUElfUk9VVEVfRVhDTFVJUk1BVEVSSUFQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsL2V4Y2x1aXIvJztcclxuICAgICAgICB2YXIgQVBJX1JPVVRFX0xJU1RBUk1BVEVSSUFQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsL2xpc3Rhci8nO1xyXG5cclxuXHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIGNhZGFzdHJhcjogY2FkYXN0cmFyLFxyXG4gICAgICAgICAgICBleGNsdWlyOiBleGNsdWlyLFxyXG4gICAgICAgICAgICBsaXN0YXJUb2RhczogbGlzdGFyVG9kYXNcclxuXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2FkYXN0cmFyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0NBREFTVFJBUk1BVEVSSUFMUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXhjbHVpcihkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RhclRvZGFzKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcblxyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDA2LzA1LzIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmNvbmZpZyhhcHBDb25maWcpO1xyXG5cclxuICAgIGFwcENvbmZpZy4kaW5qZWN0ID0gWyckbWRUaGVtaW5nUHJvdmlkZXInLCckbG9jYXRpb25Qcm92aWRlciddO1xyXG5cclxuICAgIGZ1bmN0aW9uIGFwcENvbmZpZygkbWRUaGVtaW5nUHJvdmlkZXIpIHtcclxuICAgICAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxyXG4gICAgICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ3B1cnBsZScsIHtcclxuICAgICAgICAgICAgICAgICdkZWZhdWx0JzogJzQwMCcsIC8vIGJ5IGRlZmF1bHQgdXNlIHNoYWRlIDQwMCBmcm9tIHRoZSBwaW5rIHBhbGV0dGUgZm9yIHByaW1hcnkgaW50ZW50aW9uc1xyXG4gICAgICAgICAgICAgICAgJ2h1ZS0xJzogJzEwMCcsIC8vIHVzZSBzaGFkZSAxMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMTwvY29kZT4gY2xhc3NcclxuICAgICAgICAgICAgICAgICdodWUtMic6ICc2MDAnLCAvLyB1c2Ugc2hhZGUgNjAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTI8L2NvZGU+IGNsYXNzXHJcbiAgICAgICAgICAgICAgICAnaHVlLTMnOiAnQTEwMCcgLy8gdXNlIHNoYWRlIEExMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMzwvY29kZT4gY2xhc3NcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8gSWYgeW91IHNwZWNpZnkgbGVzcyB0aGFuIGFsbCBvZiB0aGUga2V5cywgaXQgd2lsbCBpbmhlcml0IGZyb20gdGhlXHJcbiAgICAgICAgICAgIC8vIGRlZmF1bHQgc2hhZGVzXHJcbiAgICAgICAgICAgIC5hY2NlbnRQYWxldHRlKCdwdXJwbGUnLCB7XHJcbiAgICAgICAgICAgICAgICAnZGVmYXVsdCc6ICcyMDAnIC8vIHVzZSBzaGFkZSAyMDAgZm9yIGRlZmF1bHQsIGFuZCBrZWVwIGFsbCBvdGhlciBzaGFkZXMgdGhlIHNhbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbn0pKCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
