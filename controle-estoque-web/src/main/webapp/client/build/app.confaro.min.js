!function(){"use strict";angular.module("app",["ui.router","toastService","ngMaterial"]).config(["$httpProvider",function(a){}])}(),function(){"use strict";function a(a){function e(e){this.message=e,a.show({controller:"toastController",controllerAs:"vm",templateUrl:"controle-estoque-web/client/views/forms/toast.html",action:"OK",highlightAction:!0,position:"top right",hideDelay:2e3})}function t(e){this.message=e,a.show({controller:"toastController",controllerAs:"vm",templateUrl:"views/pages/dsctoast.html",action:"OK",highlightAction:!0,position:"bottom left",hideDelay:1e3})}var r={message:"",newmessage:e,errorMessageBottom:t};return r}angular.module("toastService",[]).controller("toastController",["$mdToast","toastApp",function(a,e){var t=this;t.message=e.message,t.closeToast=function(){a.hide()}}]).factory("toastApp",a),a.$inject=["$mdToast"]}(),function(){"use strict";function a(a,e){a.state("cadastroMateriaPrima",{url:"/",templateUrl:"controle-estoque-web/client/views/forms/cad_materiaprima.html",controller:"cadastroMateriaPrimaController as vm"}),e.otherwise("/")}angular.module("app").config(a),a.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function a(a,e,t){function r(){l.listaUnidades=["Kg","m"]}function i(a){l.materiaprima=a,l.isBtnRemoveMateriaPrima=!0}function o(){e.listarTodas().success(function(e){e.success?l.listaMateriaPrima=e.listaMateriaPrima:a.newmessage("Problema ao Acessar a o servidor")})}function s(r,i){var o=t.confirm().parent(angular.element(document.body)).title("Excluir Matéria prima com Sku"+i.sku).content("Materia Prima: "+i.nome).ariaLabel("Excluir Materia Prima").ok("Sim").cancel("Não").targetEvent(r);t.show(o).then(function(){e.excluir(i).success(function(e){if(e.success){for(var t=0;t<l.listaMateriaPrima.length;t++)l.listaMateriaPrima[t].id===i.id,l.listaMateriaPrima.splice(t,1);a.newmessage("Removido com sucesso!.")}else a.newmessage("Problema ao Acessar o servidor")});for(var t=0;t<l.listaMateriaPrima.length;t++)if(console.log(l.listaMateriaPrima[t].id+" === "+i.id),l.listaMateriaPrima[t].id===i.id){l.listaMateriaPrima.splice(t,1);break}l.isBtnRemoveMateriaPrima=!1,a.newmessage("Removido a Materia Prima com o SKU."+i.sku),l.materiaprima={id:null,nome:"",sku:"",unidade:"",observacao:""}})}function n(t){e.cadastrar(t).success(function(e){e.success?(l.listaMateriaPrima.push(e.materialPrima),a.newmessage("Cadastro realizado com sucesso!")):a.newmessage("Problema ao Acessar a o servidor")})}function c(a){l.reverse=l.campoOrdencao===a?!l.reverse:!1,l.campoOrdencao=a}var l=this;l.initcadastroMateriaPrima=o,l.cadastrarMateriaPrima=n,l.buscaUnidadesMateriaPrima=r,l.excluirMateriaPrima=s,l.listaUnidades,l.isBtnRemoveMateriaPrima=!1,l.materiaprima={},l.listaMateriaPrima=[],l.selecionarMateriaPrima=i,l.campoOrdencao="nome",l.reverse=!0,l.ordenaMateriaPrima=c}angular.module("app").controller("cadastroMateriaPrimaController",a),a.$inject=["toastApp","materiaPrimaService","$mdDialog"]}(),function(){"use strict";function a(a){function e(e){return a.post(i,e)}function t(e){return a.post(o,e)}function r(){return a.post(s)}var i="/controle-estoque-web/api/materialcategory/cadastrar/",o="/controle-estoque-web/api/materialcategory/excluir/",s="/controle-estoque-web/api/materialcategory/listar/",n={cadastrar:e,excluir:t,listarTodas:r};return n}angular.module("app").factory("materialCategoryService",a),a.$inject=["$http","$location"]}(),function(){"use strict";function a(a){function e(e){return a.post(i,e)}function t(e){return a.post(o,e)}function r(){return a.post(s)}var i="/controle-estoque-web/api/material/cadastrar/",o="/controle-estoque-web/api/material/excluir/",s="/controle-estoque-web/api/material/listar/",n={cadastrar:e,excluir:t,listarTodas:r};return n}angular.module("app").factory("materiaPrimaService",a),a.$inject=["$http","$location"]}(),function(){"use strict";function a(a){a.theme("default").primaryPalette("purple",{"default":"400","hue-1":"100","hue-2":"600","hue-3":"A100"}).accentPalette("purple",{"default":"200"})}angular.module("app").config(a),a.$inject=["$mdThemingProvider","$locationProvider"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZhcm8uYXBwLmpzIiwidG9hc3Quc2VydmljZS5qcyIsInJvdXRlci5hcHAuanMiLCJhcHAuY29uZmFyby5taW4uanMiLCJjYWRhc3Ryby9jYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIuanMiLCJzZXJ2aWNlL3NlcnZpY2VNYXRlcmlhbENhdGVnb3J5LmpzIiwic2VydmljZS9zZXJ2aWNlTWF0ZXJpYVByaW1hLmpzIiwiYXBwLWNvbmZpZy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsInRvYXN0QXBwIiwiJG1kVG9hc3QiLCJuZXdtZXNzYWdlIiwiZXJyb3JNZXNzYWdlIiwidGhpcyIsIm1lc3NhZ2UiLCJzaG93IiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlVXJsIiwiYWN0aW9uIiwiaGlnaGxpZ2h0QWN0aW9uIiwicG9zaXRpb24iLCJoaWRlRGVsYXkiLCJlcnJvck1lc3NhZ2VCb3R0b20iLCJzZXJ2aWNlIiwic2VsZiIsImNsb3NlVG9hc3QiLCJoaWRlIiwiZmFjdG9yeSIsIiRpbmplY3QiLCJyb3V0ZXMiLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsInN0YXRlIiwidXJsIiwib3RoZXJ3aXNlIiwiY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyIiwibWF0ZXJpYVByaW1hU2VydmljZSIsIiRtZERpYWxvZyIsImJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEiLCJsaXN0YVVuaWRhZGVzIiwic2VsZWNpb25hck1hdGVyaWFQcmltYSIsIm1hdGVyaWFQcmltYSIsIm1hdGVyaWFwcmltYSIsImlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hIiwiaW5pdGNhZGFzdHJvTWF0ZXJpYVByaW1hIiwibGlzdGFyVG9kYXMiLCJzdWNjZXNzIiwiZGF0YSIsImxpc3RhTWF0ZXJpYVByaW1hIiwiZXhjbHVpck1hdGVyaWFQcmltYSIsImV2IiwiY29uZmlybSIsInBhcmVudCIsImVsZW1lbnQiLCJkb2N1bWVudCIsImJvZHkiLCJ0aXRsZSIsInNrdSIsImNvbnRlbnQiLCJub21lIiwiYXJpYUxhYmVsIiwib2siLCJjYW5jZWwiLCJ0YXJnZXRFdmVudCIsInRoZW4iLCJleGNsdWlyIiwiaSIsImxlbmd0aCIsImlkIiwic3BsaWNlIiwiY29uc29sZSIsImxvZyIsInVuaWRhZGUiLCJvYnNlcnZhY2FvIiwiY2FkYXN0cmFyTWF0ZXJpYVByaW1hIiwiY2FkYXN0cmFyIiwicHVzaCIsIm1hdGVyaWFsUHJpbWEiLCJvcmRlbmFNYXRlcmlhUHJpbWEiLCJjYW1wb09yZGVuY2FvIiwicmV2ZXJzZSIsIm1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlIiwiJGh0dHAiLCJwb3N0IiwiQVBJX1JPVVRFX0NBREFTVFJBUk1BVEVSSUFMUFJJTUEiLCJBUElfUk9VVEVfRVhDTFVJUk1BVEVSSUFQUklNQSIsIkFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEiLCJhcHBDb25maWciLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCJ0aGVtZSIsInByaW1hcnlQYWxldHRlIiwiZGVmYXVsdCIsImh1ZS0xIiwiaHVlLTIiLCJodWUtMyIsImFjY2VudFBhbGV0dGUiXSwibWFwcGluZ3MiOiJDQUlBLFdBQ0EsWUFDQUEsU0FDQUMsT0FBQSxPQUFBLFlBQUEsZUFBQSxlQUNBQyxRQUFBLGdCQUFBLFNBQUFDLFVDTEEsV0FFQSxZQWNBLFNBQUFDLEdBQUFDLEdBaUJBLFFBQUFDLEdBQUFDLEdBQ0FDLEtBQUFDLFFBQUFGLEVBQ0FGLEVBQUFLLE1BRUFDLFdBQUEsa0JBQ0FDLGFBQUEsS0FDQUMsWUFBQSxxREFDQUMsT0FBQSxLQUNBQyxpQkFBQSxFQUNBQyxTQUFBLFlBQ0FDLFVBQUEsTUFLQSxRQUFBQyxHQUFBWCxHQUNBQyxLQUFBQyxRQUFBRixFQUNBRixFQUFBSyxNQUVBQyxXQUFBLGtCQUNBQyxhQUFBLEtBQ0FDLFlBQUEsNEJBQ0FDLE9BQUEsS0FDQUMsaUJBQUEsRUFDQUMsU0FBQSxj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Q0FKLFVBQUEsUUFqQkF2RixRQUNBQyxPQUFBLE9BQ0FDLE9BQUFpRixHQUVBQSxFQUFBM0QsU0FBQSxxQkFBQSIsImZpbGUiOiJhcHAuY29uZmFyby5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogQ3JlYXRlZCBieSBqZXN1cyBvbiAxMC8wNS8yMDE2LlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnLFsndWkucm91dGVyJywndG9hc3RTZXJ2aWNlJywnbmdNYXRlcmlhbCddKVxyXG4gICAgICAgIC5jb25maWcoZnVuY3Rpb24oJGh0dHBQcm92aWRlcikge1xyXG4gICAgICAgICAgICAvKiRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ0F1dGhJbnRlcmNlcHRvcicpOyovXHJcbiAgICAgICAgfSlcclxuXHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgSk9TRVZBTERFUkxFSSBvbiAyNy8wNi8yMDE1LlxyXG4gKi9cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCd0b2FzdFNlcnZpY2UnLFtdKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCd0b2FzdENvbnRyb2xsZXInLCBmdW5jdGlvbigkbWRUb2FzdCx0b2FzdEFwcCkge1xyXG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICAgICAgICAgIHNlbGYubWVzc2FnZSA9ICB0b2FzdEFwcC5tZXNzYWdlO1xyXG4gICAgICAgICAgICBzZWxmLmNsb3NlVG9hc3QgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICRtZFRvYXN0LmhpZGUoKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5mYWN0b3J5KCAndG9hc3RBcHAnLCB0b2FzdEFwcCApO1xyXG5cclxuICAgIHRvYXN0QXBwLiRpbmplY3QgPSBbICckbWRUb2FzdCcgXTtcclxuXHJcbiAgICBmdW5jdGlvbiB0b2FzdEFwcCAoJG1kVG9hc3QpIHtcclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgbWVzc2FnZTogJycsXHJcbiAgICAgICAgICAgIG5ld21lc3NhZ2U6IG5ld21lc3NhZ2UsXHJcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZUJvdHRvbTogZXJyb3JNZXNzYWdlQm90dG9tXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgLypmdW5jdGlvbiBlcnJvck1lc3NhZ2UoZXJyb3JNZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxyXG4gICAgICAgICAgICAgICAgLnRleHRDb250ZW50KGVycm9yTWVzc2FnZSlcclxuICAgICAgICAgICAgICAgIC5wb3NpdGlvbigndG9wIHJpZ2h0JylcclxuICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoODAwKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBuZXdtZXNzYWdlKGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3RvYXN0Q29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29udHJvbGUtZXN0b3F1ZS13ZWIvY2xpZW50L3ZpZXdzL2Zvcm1zL3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogXCJPS1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodEFjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJ0b3AgcmlnaHRcIixcclxuICAgICAgICAgICAgICAgICAgICBoaWRlRGVsYXk6IDIwMDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yTWVzc2FnZUJvdHRvbShlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd0b2FzdENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3BhZ2VzL2RzY3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogXCJPS1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodEFjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJib3R0b20gbGVmdFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVEZWxheTogMTAwMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgSk9TRVZBTERFUkxFSSBvbiAyNS8wNi8yMDE1LlxyXG4gKi9cclxuKGZ1bmN0aW9uKCl7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwJylcclxuICAgICAgICAuY29uZmlnKHJvdXRlcyk7XHJcbiAgICBmdW5jdGlvbiByb3V0ZXMoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xyXG4gICAgICAgICRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdjYWRhc3Ryb01hdGVyaWFQcmltYScsIHtcclxuICAgICAgICAgICAgdXJsOiAnLycsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29udHJvbGUtZXN0b3F1ZS13ZWIvY2xpZW50L3ZpZXdzL2Zvcm1zL2NhZF9tYXRlcmlhcHJpbWEuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIgYXMgdm0nXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcclxuXHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG4iLCIvKipcclxuICogQ3JlYXRlZCBieSBqZXN1cyBvbiAxMC8wNS8yMDE2LlxyXG4gKi9cclxuXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnLFsndWkucm91dGVyJywndG9hc3RTZXJ2aWNlJywnbmdNYXRlcmlhbCddKVxyXG4gICAgICAgIC5jb25maWcoW1wiJGh0dHBQcm92aWRlclwiLCBmdW5jdGlvbigkaHR0cFByb3ZpZGVyKSB7XHJcbiAgICAgICAgICAgIC8qJGh0dHBQcm92aWRlci5pbnRlcmNlcHRvcnMucHVzaCgnQXV0aEludGVyY2VwdG9yJyk7Ki9cclxuICAgICAgICB9XSlcclxuXHJcbn0pKCk7XG4vKipcclxuICogQ3JlYXRlZCBieSBKT1NFVkFMREVSTEVJIG9uIDI3LzA2LzIwMTUuXHJcbiAqL1xyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ3RvYXN0U2VydmljZScsW10pXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ3RvYXN0Q29udHJvbGxlcicsIFtcIiRtZFRvYXN0XCIsIFwidG9hc3RBcHBcIiwgZnVuY3Rpb24oJG1kVG9hc3QsdG9hc3RBcHApIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICBzZWxmLm1lc3NhZ2UgPSAgdG9hc3RBcHAubWVzc2FnZTtcclxuICAgICAgICAgICAgc2VsZi5jbG9zZVRvYXN0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5oaWRlKCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfV0pXHJcbiAgICAgICAgLmZhY3RvcnkoICd0b2FzdEFwcCcsIHRvYXN0QXBwICk7XHJcblxyXG4gICAgdG9hc3RBcHAuJGluamVjdCA9IFsgJyRtZFRvYXN0JyBdO1xyXG5cclxuICAgIGZ1bmN0aW9uIHRvYXN0QXBwICgkbWRUb2FzdCkge1xyXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xyXG4gICAgICAgICAgICBtZXNzYWdlOiAnJyxcclxuICAgICAgICAgICAgbmV3bWVzc2FnZTogbmV3bWVzc2FnZSxcclxuICAgICAgICAgICAgZXJyb3JNZXNzYWdlQm90dG9tOiBlcnJvck1lc3NhZ2VCb3R0b21cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICAvKmZ1bmN0aW9uIGVycm9yTWVzc2FnZShlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcclxuICAgICAgICAgICAgICAgICRtZFRvYXN0LnNpbXBsZSgpXHJcbiAgICAgICAgICAgICAgICAudGV4dENvbnRlbnQoZXJyb3JNZXNzYWdlKVxyXG4gICAgICAgICAgICAgICAgLnBvc2l0aW9uKCd0b3AgcmlnaHQnKVxyXG4gICAgICAgICAgICAgICAgLmhpZGVEZWxheSg4MDApXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfSovXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG5ld21lc3NhZ2UoZXJyb3JNZXNzYWdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IGVycm9yTWVzc2FnZTtcclxuICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAndG9hc3RDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb250cm9sZS1lc3RvcXVlLXdlYi9jbGllbnQvdmlld3MvZm9ybXMvdG9hc3QuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBcIk9LXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0QWN0aW9uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBcInRvcCByaWdodFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVEZWxheTogMjAwMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXJyb3JNZXNzYWdlQm90dG9tKGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3RvYXN0Q29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndmlld3MvcGFnZXMvZHNjdG9hc3QuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uOiBcIk9LXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaGlnaGxpZ2h0QWN0aW9uOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBcImJvdHRvbSBsZWZ0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaGlkZURlbGF5OiAxMDAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cbi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEpPU0VWQUxERVJMRUkgb24gMjUvMDYvMjAxNS5cclxuICovXHJcbihmdW5jdGlvbigpe1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmNvbmZpZyhyb3V0ZXMpO1xyXG4gICAgZnVuY3Rpb24gcm91dGVzKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcclxuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY2FkYXN0cm9NYXRlcmlhUHJpbWEnLCB7XHJcbiAgICAgICAgICAgIHVybDogJy8nLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbnRyb2xlLWVzdG9xdWUtd2ViL2NsaWVudC92aWV3cy9mb3Jtcy9jYWRfbWF0ZXJpYXByaW1hLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyIGFzIHZtJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XHJcblxyXG4gICAgfVxyXG4gICAgcm91dGVzLiRpbmplY3QgPSBbXCIkc3RhdGVQcm92aWRlclwiLCBcIiR1cmxSb3V0ZXJQcm92aWRlclwiXTtcclxuXHJcbn0pKCk7XHJcblxuLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTAvMDUvMjAxNi5cclxuICovXHJcblxyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ2NhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlcicsIGNhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlcik7XHJcblxyXG4gICAgZnVuY3Rpb24gY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyKHRvYXN0QXBwLG1hdGVyaWFQcmltYVNlcnZpY2UsJG1kRGlhbG9nKXtcclxuXHJcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHNlbGYuaW5pdGNhZGFzdHJvTWF0ZXJpYVByaW1hID0gaW5pdGNhZGFzdHJvTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuY2FkYXN0cmFyTWF0ZXJpYVByaW1hID0gY2FkYXN0cmFyTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuYnVzY2FVbmlkYWRlc01hdGVyaWFQcmltYSA9IGJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgc2VsZi5leGNsdWlyTWF0ZXJpYVByaW1hID0gZXhjbHVpck1hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmxpc3RhVW5pZGFkZXM7XHJcbiAgICAgICAgc2VsZi5pc0J0blJlbW92ZU1hdGVyaWFQcmltYSA9IGZhbHNlO1xyXG4gICAgICAgIHNlbGYubWF0ZXJpYXByaW1hID0ge307XHJcbiAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYSA9IFtdO1xyXG4gICAgICAgIHNlbGYuc2VsZWNpb25hck1hdGVyaWFQcmltYSA9IHNlbGVjaW9uYXJNYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgc2VsZi5jYW1wb09yZGVuY2FvID0gJ25vbWUnO1xyXG4gICAgICAgIHNlbGYucmV2ZXJzZSA9IHRydWU7XHJcbiAgICAgICAgc2VsZi5vcmRlbmFNYXRlcmlhUHJpbWEgPSBvcmRlbmFNYXRlcmlhUHJpbWE7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEoKXtcclxuICAgICAgICAgICAgc2VsZi5saXN0YVVuaWRhZGVzID0gWydLZycsJ20nXVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2VsZWNpb25hck1hdGVyaWFQcmltYSAobWF0ZXJpYVByaW1hKXtcclxuICAgICAgICAgICAgc2VsZi5tYXRlcmlhcHJpbWEgPSBtYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgICAgIHNlbGYuaXNCdG5SZW1vdmVNYXRlcmlhUHJpbWEgPSB0cnVlO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGluaXRjYWRhc3Ryb01hdGVyaWFQcmltYSgpe1xyXG4gICAgICAgICAgICBtYXRlcmlhUHJpbWFTZXJ2aWNlLmxpc3RhclRvZGFzKClcclxuICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgIGlmKGRhdGEuc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYSA9IGRhdGEubGlzdGFNYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ1Byb2JsZW1hIGFvIEFjZXNzYXIgYSBvIHNlcnZpZG9yJyk7XHJcbiAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgICAgLyogIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IDEsIG5vbWU6IFwiWCBUZWNpZG9cIiwgc2t1OiBcIjAwMDAwWDk5OVwiLCB1bmlkYWRlOiBcIktHXCIsIG9ic2VydmFjYW86IFwiVGVzdGUgZGUgWFwifTtcclxuICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiAgICAgICAgICAgIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IDIsIG5vbWU6IFwiQiBUZWNpZG9cIiwgc2t1OiBcIjAwMDAwQjAwM1wiLCB1bmlkYWRlOiBcIktHXCIsIG9ic2VydmFjYW86IFwiVGVzdGUgZGUgQlwifTtcclxuICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiAgICAgICAgICAgIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IDMsIG5vbWU6IFwiQSBUZWNpZG9cIiwgc2t1OiBcIjAwMDAwWDk5OVwiLCB1bmlkYWRlOiBcIktHXCIsIG9ic2VydmFjYW86IFwiVGVzdGUgZGUgQVwifTtcclxuICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiovXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXhjbHVpck1hdGVyaWFQcmltYShldixtYXRlcmlhUHJpbWEpe1xyXG4gICAgICAgICAgICB2YXIgY29uZmlybSA9ICRtZERpYWxvZy5jb25maXJtKClcclxuICAgICAgICAgICAgICAgIC5wYXJlbnQoYW5ndWxhci5lbGVtZW50KGRvY3VtZW50LmJvZHkpKVxyXG4gICAgICAgICAgICAgICAgLnRpdGxlKCdFeGNsdWlyIE1hdMOpcmlhIHByaW1hIGNvbSBTa3UnICsgbWF0ZXJpYVByaW1hLnNrdSlcclxuICAgICAgICAgICAgICAgIC5jb250ZW50KCdNYXRlcmlhIFByaW1hOiAnICsgbWF0ZXJpYVByaW1hLm5vbWUpXHJcbiAgICAgICAgICAgICAgICAuYXJpYUxhYmVsKCdFeGNsdWlyIE1hdGVyaWEgUHJpbWEnKVxyXG4gICAgICAgICAgICAgICAgLm9rKCdTaW0nKVxyXG4gICAgICAgICAgICAgICAgLmNhbmNlbCgnTsOjbycpXHJcbiAgICAgICAgICAgICAgICAudGFyZ2V0RXZlbnQoZXYpO1xyXG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyhjb25maXJtKS50aGVuKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgbWF0ZXJpYVByaW1hU2VydmljZS5leGNsdWlyKG1hdGVyaWFQcmltYSlcclxuICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgaWYoZGF0YS5zdWNjZXNzKSB7XHJcbiAgICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7IGkgPCBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hW2ldLmlkID09PSBtYXRlcmlhUHJpbWEuaWQ7XHJcbiAgICAgICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5zcGxpY2UoaSwxKTtcclxuICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnUmVtb3ZpZG8gY29tIHN1Y2Vzc28hLicpO1xyXG4gICAgICAgICAgICAgICAgIH1lbHNle1xyXG4gICAgICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ1Byb2JsZW1hIGFvIEFjZXNzYXIgbyBzZXJ2aWRvcicpO1xyXG4gICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IodmFyIGk9MDsgaSA8IHNlbGYubGlzdGFNYXRlcmlhUHJpbWEubGVuZ3RoOyBpKyspe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYubGlzdGFNYXRlcmlhUHJpbWFbaV0uaWQgKyAnID09PSAnICsgIG1hdGVyaWFQcmltYS5pZClcclxuICAgICAgICAgICAgICAgICAgICBpZihzZWxmLmxpc3RhTWF0ZXJpYVByaW1hW2ldLmlkID09PSBtYXRlcmlhUHJpbWEuaWQpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnNwbGljZShpLDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxmLmlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdSZW1vdmlkbyBhIE1hdGVyaWEgUHJpbWEgY29tIG8gU0tVLicgKyBtYXRlcmlhUHJpbWEuc2t1KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHtpZDogbnVsbCxub21lOiBcIlwiLCBza3U6IFwiXCIsIHVuaWRhZGU6IFwiXCIsIG9ic2VydmFjYW86IFwiXCJ9O1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGNhZGFzdHJhck1hdGVyaWFQcmltYShtYXRlcmlhUHJpbWEpe1xyXG5cclxuICAgICAgICAgICAgIG1hdGVyaWFQcmltYVNlcnZpY2UuY2FkYXN0cmFyKG1hdGVyaWFQcmltYSlcclxuICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgIGlmKGRhdGEuc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKGRhdGEubWF0ZXJpYWxQcmltYSk7XHJcbiAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdDYWRhc3RybyByZWFsaXphZG8gY29tIHN1Y2Vzc28hJyk7XHJcbiAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ1Byb2JsZW1hIGFvIEFjZXNzYXIgYSBvIHNlcnZpZG9yJyk7XHJcbiAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAvKiAgdmFyIG1hdGVyaWFwcmltYSA9IHtpZDogc2VsZi5saXN0YU1hdGVyaWFQcmltYS5sZW5ndGgrMSwgbm9tZTogbWF0ZXJpYVByaW1hLm5vbWUsIHNrdTogbWF0ZXJpYVByaW1hLnNrdSwgdW5pZGFkZTogbWF0ZXJpYVByaW1hLnVuaWRhZGUsIG9ic2VydmFjYW86IG1hdGVyaWFQcmltYS5vYnNlcnZhY2FvfTtcclxuICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiAgICAgICAgICAgIHNlbGYubWF0ZXJpYXByaW1hID0ge2lkOiBudWxsLG5vbWU6IFwiXCIsIHNrdTogXCJcIiwgdW5pZGFkZTogXCJcIiwgb2JzZXJ2YWNhbzogXCJcIn07XHJcbiAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ0NhZGFzdHJvIHJlYWxpemFkbyBjb20gc3VjZXNzbyBwYXJhIG8gU0tVLicgKyBtYXRlcmlhUHJpbWEuc2t1KTtcclxuKi9cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9yZGVuYU1hdGVyaWFQcmltYShjYW1wb09yZGVuY2FvKXtcclxuICAgICAgICAgICAgc2VsZi5yZXZlcnNlID0gKHNlbGYuY2FtcG9PcmRlbmNhbyA9PT0gY2FtcG9PcmRlbmNhbykgPyAhc2VsZi5yZXZlcnNlIDogZmFsc2U7XHJcbiAgICAgICAgICAgIHNlbGYuY2FtcG9PcmRlbmNhbyA9IGNhbXBvT3JkZW5jYW87XHJcblxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG4gICAgY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyLiRpbmplY3QgPSBbXCJ0b2FzdEFwcFwiLCBcIm1hdGVyaWFQcmltYVNlcnZpY2VcIiwgXCIkbWREaWFsb2dcIl07XHJcblxyXG59KSgpO1xuLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTEvMDUvMjAxNi5cclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5mYWN0b3J5KCdtYXRlcmlhbENhdGVnb3J5U2VydmljZScsIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlKTtcclxuXHJcbiAgICBtYXRlcmlhbENhdGVnb3J5U2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsJyRsb2NhdGlvbiddO1xyXG5cclxuICAgIGZ1bmN0aW9uIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlKCRodHRwKSB7XHJcblxyXG4gICAgICAgIHZhciBBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsY2F0ZWdvcnkvY2FkYXN0cmFyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWxjYXRlZ29yeS9leGNsdWlyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEgPSAnL2NvbnRyb2xlLWVzdG9xdWUtd2ViL2FwaS9tYXRlcmlhbGNhdGVnb3J5L2xpc3Rhci8nO1xyXG5cclxuXHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIGNhZGFzdHJhcjogY2FkYXN0cmFyLFxyXG4gICAgICAgICAgICBleGNsdWlyOiBleGNsdWlyLFxyXG4gICAgICAgICAgICBsaXN0YXJUb2RhczogbGlzdGFyVG9kYXNcclxuXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2FkYXN0cmFyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0NBREFTVFJBUk1BVEVSSUFMUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXhjbHVpcihkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RhclRvZGFzKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcblxyXG59KSgpO1xuLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTEvMDUvMjAxNi5cclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5mYWN0b3J5KCdtYXRlcmlhUHJpbWFTZXJ2aWNlJywgbWF0ZXJpYVByaW1hU2VydmljZSk7XHJcblxyXG4gICAgbWF0ZXJpYVByaW1hU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsJyRsb2NhdGlvbiddO1xyXG5cclxuICAgIGZ1bmN0aW9uIG1hdGVyaWFQcmltYVNlcnZpY2UoJGh0dHApIHtcclxuXHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9DQURBU1RSQVJNQVRFUklBTFBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWwvY2FkYXN0cmFyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWwvZXhjbHVpci8nO1xyXG4gICAgICAgIHZhciBBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWwvbGlzdGFyLyc7XHJcblxyXG5cclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgY2FkYXN0cmFyOiBjYWRhc3RyYXIsXHJcbiAgICAgICAgICAgIGV4Y2x1aXI6IGV4Y2x1aXIsXHJcbiAgICAgICAgICAgIGxpc3RhclRvZGFzOiBsaXN0YXJUb2Rhc1xyXG5cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjYWRhc3RyYXIoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGNsdWlyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGlzdGFyVG9kYXMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuXHJcbn0pKCk7XG4vKipcclxuICogQ3JlYXRlZCBieSBqZXN1cyBvbiAwNi8wNS8yMDE2LlxyXG4gKi9cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5jb25maWcoYXBwQ29uZmlnKTtcclxuXHJcbiAgICBhcHBDb25maWcuJGluamVjdCA9IFsnJG1kVGhlbWluZ1Byb3ZpZGVyJywnJGxvY2F0aW9uUHJvdmlkZXInXTtcclxuXHJcbiAgICBmdW5jdGlvbiBhcHBDb25maWcoJG1kVGhlbWluZ1Byb3ZpZGVyKSB7XHJcbiAgICAgICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcclxuICAgICAgICAgICAgLnByaW1hcnlQYWxldHRlKCdwdXJwbGUnLCB7XHJcbiAgICAgICAgICAgICAgICAnZGVmYXVsdCc6ICc0MDAnLCAvLyBieSBkZWZhdWx0IHVzZSBzaGFkZSA0MDAgZnJvbSB0aGUgcGluayBwYWxldHRlIGZvciBwcmltYXJ5IGludGVudGlvbnNcclxuICAgICAgICAgICAgICAgICdodWUtMSc6ICcxMDAnLCAvLyB1c2Ugc2hhZGUgMTAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTE8L2NvZGU+IGNsYXNzXHJcbiAgICAgICAgICAgICAgICAnaHVlLTInOiAnNjAwJywgLy8gdXNlIHNoYWRlIDYwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0yPC9jb2RlPiBjbGFzc1xyXG4gICAgICAgICAgICAgICAgJ2h1ZS0zJzogJ0ExMDAnIC8vIHVzZSBzaGFkZSBBMTAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTM8L2NvZGU+IGNsYXNzXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC8vIElmIHlvdSBzcGVjaWZ5IGxlc3MgdGhhbiBhbGwgb2YgdGhlIGtleXMsIGl0IHdpbGwgaW5oZXJpdCBmcm9tIHRoZVxyXG4gICAgICAgICAgICAvLyBkZWZhdWx0IHNoYWRlc1xyXG4gICAgICAgICAgICAuYWNjZW50UGFsZXR0ZSgncHVycGxlJywge1xyXG4gICAgICAgICAgICAgICAgJ2RlZmF1bHQnOiAnMjAwJyAvLyB1c2Ugc2hhZGUgMjAwIGZvciBkZWZhdWx0LCBhbmQga2VlcCBhbGwgb3RoZXIgc2hhZGVzIHRoZSBzYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDEwLzA1LzIwMTYuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCdjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXInLCBjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlcih0b2FzdEFwcCxtYXRlcmlhUHJpbWFTZXJ2aWNlLCRtZERpYWxvZyl7XHJcblxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLmluaXRjYWRhc3Ryb01hdGVyaWFQcmltYSA9IGluaXRjYWRhc3Ryb01hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmNhZGFzdHJhck1hdGVyaWFQcmltYSA9IGNhZGFzdHJhck1hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEgPSBidXNjYVVuaWRhZGVzTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuZXhjbHVpck1hdGVyaWFQcmltYSA9IGV4Y2x1aXJNYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgc2VsZi5saXN0YVVuaWRhZGVzO1xyXG4gICAgICAgIHNlbGYuaXNCdG5SZW1vdmVNYXRlcmlhUHJpbWEgPSBmYWxzZTtcclxuICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHt9O1xyXG4gICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEgPSBbXTtcclxuICAgICAgICBzZWxmLnNlbGVjaW9uYXJNYXRlcmlhUHJpbWEgPSBzZWxlY2lvbmFyTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuY2FtcG9PcmRlbmNhbyA9ICdub21lJztcclxuICAgICAgICBzZWxmLnJldmVyc2UgPSB0cnVlO1xyXG4gICAgICAgIHNlbGYub3JkZW5hTWF0ZXJpYVByaW1hID0gb3JkZW5hTWF0ZXJpYVByaW1hO1xyXG5cclxuXHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBidXNjYVVuaWRhZGVzTWF0ZXJpYVByaW1hKCl7XHJcbiAgICAgICAgICAgIHNlbGYubGlzdGFVbmlkYWRlcyA9IFsnS2cnLCdtJ11cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjaW9uYXJNYXRlcmlhUHJpbWEgKG1hdGVyaWFQcmltYSl7XHJcbiAgICAgICAgICAgIHNlbGYubWF0ZXJpYXByaW1hID0gbWF0ZXJpYVByaW1hO1xyXG4gICAgICAgICAgICBzZWxmLmlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpbml0Y2FkYXN0cm9NYXRlcmlhUHJpbWEoKXtcclxuICAgICAgICAgICAgbWF0ZXJpYVByaW1hU2VydmljZS5saXN0YXJUb2RhcygpXHJcbiAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICBpZihkYXRhLnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEgPSBkYXRhLmxpc3RhTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdQcm9ibGVtYSBhbyBBY2Vzc2FyIGEgbyBzZXJ2aWRvcicpO1xyXG4gICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAgIC8qICB2YXIgbWF0ZXJpYXByaW1hID0ge2lkOiAxLCBub21lOiBcIlggVGVjaWRvXCIsIHNrdTogXCIwMDAwMFg5OTlcIiwgdW5pZGFkZTogXCJLR1wiLCBvYnNlcnZhY2FvOiBcIlRlc3RlIGRlIFhcIn07XHJcbiAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhcHJpbWEpO1xyXG4gICAgICAgICAgICB2YXIgbWF0ZXJpYXByaW1hID0ge2lkOiAyLCBub21lOiBcIkIgVGVjaWRvXCIsIHNrdTogXCIwMDAwMEIwMDNcIiwgdW5pZGFkZTogXCJLR1wiLCBvYnNlcnZhY2FvOiBcIlRlc3RlIGRlIEJcIn07XHJcbiAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhcHJpbWEpO1xyXG4gICAgICAgICAgICB2YXIgbWF0ZXJpYXByaW1hID0ge2lkOiAzLCBub21lOiBcIkEgVGVjaWRvXCIsIHNrdTogXCIwMDAwMFg5OTlcIiwgdW5pZGFkZTogXCJLR1wiLCBvYnNlcnZhY2FvOiBcIlRlc3RlIGRlIEFcIn07XHJcbiAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhcHJpbWEpO1xyXG4qL1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGV4Y2x1aXJNYXRlcmlhUHJpbWEoZXYsbWF0ZXJpYVByaW1hKXtcclxuICAgICAgICAgICAgdmFyIGNvbmZpcm0gPSAkbWREaWFsb2cuY29uZmlybSgpXHJcbiAgICAgICAgICAgICAgICAucGFyZW50KGFuZ3VsYXIuZWxlbWVudChkb2N1bWVudC5ib2R5KSlcclxuICAgICAgICAgICAgICAgIC50aXRsZSgnRXhjbHVpciBNYXTDqXJpYSBwcmltYSBjb20gU2t1JyArIG1hdGVyaWFQcmltYS5za3UpXHJcbiAgICAgICAgICAgICAgICAuY29udGVudCgnTWF0ZXJpYSBQcmltYTogJyArIG1hdGVyaWFQcmltYS5ub21lKVxyXG4gICAgICAgICAgICAgICAgLmFyaWFMYWJlbCgnRXhjbHVpciBNYXRlcmlhIFByaW1hJylcclxuICAgICAgICAgICAgICAgIC5vaygnU2ltJylcclxuICAgICAgICAgICAgICAgIC5jYW5jZWwoJ07Do28nKVxyXG4gICAgICAgICAgICAgICAgLnRhcmdldEV2ZW50KGV2KTtcclxuICAgICAgICAgICAgJG1kRGlhbG9nLnNob3coY29uZmlybSkudGhlbihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIG1hdGVyaWFQcmltYVNlcnZpY2UuZXhjbHVpcihtYXRlcmlhUHJpbWEpXHJcbiAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgIGlmKGRhdGEuc3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgIGZvcih2YXIgaT0wOyBpIDwgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5sZW5ndGg7IGkrKyl7XHJcbiAgICAgICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYVtpXS5pZCA9PT0gbWF0ZXJpYVByaW1hLmlkO1xyXG4gICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEuc3BsaWNlKGksMSk7XHJcbiAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ1JlbW92aWRvIGNvbSBzdWNlc3NvIS4nKTtcclxuICAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdQcm9ibGVtYSBhbyBBY2Vzc2FyIG8gc2Vydmlkb3InKTtcclxuICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yKHZhciBpPTA7IGkgPCBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLmxlbmd0aDsgaSsrKXtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLmxpc3RhTWF0ZXJpYVByaW1hW2ldLmlkICsgJyA9PT0gJyArICBtYXRlcmlhUHJpbWEuaWQpXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoc2VsZi5saXN0YU1hdGVyaWFQcmltYVtpXS5pZCA9PT0gbWF0ZXJpYVByaW1hLmlkKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5zcGxpY2UoaSwxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgc2VsZi5pc0J0blJlbW92ZU1hdGVyaWFQcmltYSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnUmVtb3ZpZG8gYSBNYXRlcmlhIFByaW1hIGNvbSBvIFNLVS4nICsgbWF0ZXJpYVByaW1hLnNrdSk7XHJcblxyXG4gICAgICAgICAgICAgICAgc2VsZi5tYXRlcmlhcHJpbWEgPSB7aWQ6IG51bGwsbm9tZTogXCJcIiwgc2t1OiBcIlwiLCB1bmlkYWRlOiBcIlwiLCBvYnNlcnZhY2FvOiBcIlwifTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH1cclxuICAgICAgICBmdW5jdGlvbiBjYWRhc3RyYXJNYXRlcmlhUHJpbWEobWF0ZXJpYVByaW1hKXtcclxuXHJcbiAgICAgICAgICAgICBtYXRlcmlhUHJpbWFTZXJ2aWNlLmNhZGFzdHJhcihtYXRlcmlhUHJpbWEpXHJcbiAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICBpZihkYXRhLnN1Y2Nlc3MpIHtcclxuICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChkYXRhLm1hdGVyaWFsUHJpbWEpO1xyXG4gICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnQ2FkYXN0cm8gcmVhbGl6YWRvIGNvbSBzdWNlc3NvIScpO1xyXG4gICAgICAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdQcm9ibGVtYSBhbyBBY2Vzc2FyIGEgbyBzZXJ2aWRvcicpO1xyXG4gICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgLyogIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IHNlbGYubGlzdGFNYXRlcmlhUHJpbWEubGVuZ3RoKzEsIG5vbWU6IG1hdGVyaWFQcmltYS5ub21lLCBza3U6IG1hdGVyaWFQcmltYS5za3UsIHVuaWRhZGU6IG1hdGVyaWFQcmltYS51bmlkYWRlLCBvYnNlcnZhY2FvOiBtYXRlcmlhUHJpbWEub2JzZXJ2YWNhb307XHJcbiAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhcHJpbWEpO1xyXG4gICAgICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHtpZDogbnVsbCxub21lOiBcIlwiLCBza3U6IFwiXCIsIHVuaWRhZGU6IFwiXCIsIG9ic2VydmFjYW86IFwiXCJ9O1xyXG4gICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdDYWRhc3RybyByZWFsaXphZG8gY29tIHN1Y2Vzc28gcGFyYSBvIFNLVS4nICsgbWF0ZXJpYVByaW1hLnNrdSk7XHJcbiovXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvcmRlbmFNYXRlcmlhUHJpbWEoY2FtcG9PcmRlbmNhbyl7XHJcbiAgICAgICAgICAgIHNlbGYucmV2ZXJzZSA9IChzZWxmLmNhbXBvT3JkZW5jYW8gPT09IGNhbXBvT3JkZW5jYW8pID8gIXNlbGYucmV2ZXJzZSA6IGZhbHNlO1xyXG4gICAgICAgICAgICBzZWxmLmNhbXBvT3JkZW5jYW8gPSBjYW1wb09yZGVuY2FvO1xyXG5cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTEvMDUvMjAxNi5cclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5mYWN0b3J5KCdtYXRlcmlhbENhdGVnb3J5U2VydmljZScsIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlKTtcclxuXHJcbiAgICBtYXRlcmlhbENhdGVnb3J5U2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsJyRsb2NhdGlvbiddO1xyXG5cclxuICAgIGZ1bmN0aW9uIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlKCRodHRwKSB7XHJcblxyXG4gICAgICAgIHZhciBBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsY2F0ZWdvcnkvY2FkYXN0cmFyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWxjYXRlZ29yeS9leGNsdWlyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEgPSAnL2NvbnRyb2xlLWVzdG9xdWUtd2ViL2FwaS9tYXRlcmlhbGNhdGVnb3J5L2xpc3Rhci8nO1xyXG5cclxuXHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIGNhZGFzdHJhcjogY2FkYXN0cmFyLFxyXG4gICAgICAgICAgICBleGNsdWlyOiBleGNsdWlyLFxyXG4gICAgICAgICAgICBsaXN0YXJUb2RhczogbGlzdGFyVG9kYXNcclxuXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2FkYXN0cmFyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0NBREFTVFJBUk1BVEVSSUFMUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXhjbHVpcihkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RhclRvZGFzKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcblxyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDExLzA1LzIwMTYuXHJcbiAqL1xyXG5cclxuXHJcbihmdW5jdGlvbigpe1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwJylcclxuICAgICAgICAuZmFjdG9yeSgnbWF0ZXJpYVByaW1hU2VydmljZScsIG1hdGVyaWFQcmltYVNlcnZpY2UpO1xyXG5cclxuICAgIG1hdGVyaWFQcmltYVNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnLCckbG9jYXRpb24nXTtcclxuXHJcbiAgICBmdW5jdGlvbiBtYXRlcmlhUHJpbWFTZXJ2aWNlKCRodHRwKSB7XHJcblxyXG4gICAgICAgIHZhciBBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsL2NhZGFzdHJhci8nO1xyXG4gICAgICAgIHZhciBBUElfUk9VVEVfRVhDTFVJUk1BVEVSSUFQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsL2V4Y2x1aXIvJztcclxuICAgICAgICB2YXIgQVBJX1JPVVRFX0xJU1RBUk1BVEVSSUFQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsL2xpc3Rhci8nO1xyXG5cclxuXHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIGNhZGFzdHJhcjogY2FkYXN0cmFyLFxyXG4gICAgICAgICAgICBleGNsdWlyOiBleGNsdWlyLFxyXG4gICAgICAgICAgICBsaXN0YXJUb2RhczogbGlzdGFyVG9kYXNcclxuXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2FkYXN0cmFyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0NBREFTVFJBUk1BVEVSSUFMUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXhjbHVpcihkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RhclRvZGFzKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcblxyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDA2LzA1LzIwMTYuXHJcbiAqL1xyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmNvbmZpZyhhcHBDb25maWcpO1xyXG5cclxuICAgIGFwcENvbmZpZy4kaW5qZWN0ID0gWyckbWRUaGVtaW5nUHJvdmlkZXInLCckbG9jYXRpb25Qcm92aWRlciddO1xyXG5cclxuICAgIGZ1bmN0aW9uIGFwcENvbmZpZygkbWRUaGVtaW5nUHJvdmlkZXIpIHtcclxuICAgICAgICAkbWRUaGVtaW5nUHJvdmlkZXIudGhlbWUoJ2RlZmF1bHQnKVxyXG4gICAgICAgICAgICAucHJpbWFyeVBhbGV0dGUoJ3B1cnBsZScsIHtcclxuICAgICAgICAgICAgICAgICdkZWZhdWx0JzogJzQwMCcsIC8vIGJ5IGRlZmF1bHQgdXNlIHNoYWRlIDQwMCBmcm9tIHRoZSBwaW5rIHBhbGV0dGUgZm9yIHByaW1hcnkgaW50ZW50aW9uc1xyXG4gICAgICAgICAgICAgICAgJ2h1ZS0xJzogJzEwMCcsIC8vIHVzZSBzaGFkZSAxMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMTwvY29kZT4gY2xhc3NcclxuICAgICAgICAgICAgICAgICdodWUtMic6ICc2MDAnLCAvLyB1c2Ugc2hhZGUgNjAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTI8L2NvZGU+IGNsYXNzXHJcbiAgICAgICAgICAgICAgICAnaHVlLTMnOiAnQTEwMCcgLy8gdXNlIHNoYWRlIEExMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMzwvY29kZT4gY2xhc3NcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLy8gSWYgeW91IHNwZWNpZnkgbGVzcyB0aGFuIGFsbCBvZiB0aGUga2V5cywgaXQgd2lsbCBpbmhlcml0IGZyb20gdGhlXHJcbiAgICAgICAgICAgIC8vIGRlZmF1bHQgc2hhZGVzXHJcbiAgICAgICAgICAgIC5hY2NlbnRQYWxldHRlKCdwdXJwbGUnLCB7XHJcbiAgICAgICAgICAgICAgICAnZGVmYXVsdCc6ICcyMDAnIC8vIHVzZSBzaGFkZSAyMDAgZm9yIGRlZmF1bHQsIGFuZCBrZWVwIGFsbCBvdGhlciBzaGFkZXMgdGhlIHNhbWVcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG5cclxuXHJcbn0pKCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
