!function(){"use strict";angular.module("app",["ui.router","toastService","ngMaterial"]).config(["$httpProvider",function(a){}])}(),function(){"use strict";function a(a){function e(e){this.message=e,a.show({controller:"toastController",controllerAs:"vm",templateUrl:"controle-estoque-web/client/views/forms/toast.html",action:"OK",highlightAction:!0,position:"top right",hideDelay:2e3})}function t(e){this.message=e,a.show({controller:"toastController",controllerAs:"vm",templateUrl:"views/pages/dsctoast.html",action:"OK",highlightAction:!0,position:"bottom left",hideDelay:1e3})}var r={message:"",newmessage:e,errorMessageBottom:t};return r}angular.module("toastService",[]).controller("toastController",["$mdToast","toastApp",function(a,e){var t=this;t.message=e.message,t.closeToast=function(){a.hide()}}]).factory("toastApp",a),a.$inject=["$mdToast"]}(),function(){"use strict";function a(a,e){a.state("cadastroMateriaPrima",{url:"/",templateUrl:"controle-estoque-web/client/views/forms/cad_materiaprima.html",controller:"cadastroMateriaPrimaController as vm"}),e.otherwise("/")}angular.module("app").config(a),a.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function a(a,e,t){function r(){l.listaUnidades=["Kg","m"]}function i(a){l.materiaprima=a,l.isBtnRemoveMateriaPrima=!0}function o(){e.listarTodas().success(function(a){console.log(a),l.listaMateriaPrima=a})}function n(r,i){var o=t.confirm().parent(angular.element(document.body)).title("Excluir Matéria prima com Sku"+i.skuCode).content("Materia Prima: "+i.name).ariaLabel("Excluir Materia Prima").ok("Sim").cancel("Não").targetEvent(r);t.show(o).then(function(){e.excluir(i).success(function(e){if(e){for(var t=0;t<l.listaMateriaPrima.length;t++)l.listaMateriaPrima[t].id===i.id,l.listaMateriaPrima.splice(t,1);a.newmessage("Removido com sucesso!.")}else a.newmessage("Problema ao Acessar o servidor")});for(var t=0;t<l.listaMateriaPrima.length;t++)if(console.log(l.listaMateriaPrima[t].id+" === "+i.id),l.listaMateriaPrima[t].id===i.id){l.listaMateriaPrima.splice(t,1);break}l.isBtnRemoveMateriaPrima=!1,a.newmessage("Removido a Materia Prima com o SKU."+i.sku),l.materiaprima={id:null,name:"",skuCode:"",measuringUnit:"",description:""}})}function s(t){e.cadastrar(t).success(function(e){console.log(e),e?(l.listaMateriaPrima.push(t),a.newmessage("Cadastro realizado com sucesso!")):a.newmessage("Problema ao Acessar a o servidor")})}function c(a){l.reverse=l.campoOrdencao===a?!l.reverse:!1,l.campoOrdencao=a}var l=this;l.initcadastroMateriaPrima=o,l.cadastrarMateriaPrima=s,l.buscaUnidadesMateriaPrima=r,l.excluirMateriaPrima=n,l.listaUnidades,l.isBtnRemoveMateriaPrima=!1,l.materiaprima={},l.listaMateriaPrima=[],l.selecionarMateriaPrima=i,l.campoOrdencao="nome",l.reverse=!0,l.ordenaMateriaPrima=c}angular.module("app").controller("cadastroMateriaPrimaController",a),a.$inject=["toastApp","materiaPrimaService","$mdDialog"]}(),function(){"use strict";function a(a){function e(e){return a.post(i,e)}function t(e){return a.post(o,e)}function r(){return a.post(n)}var i="/controle-estoque-web/api/materialcategory/cadastrar/",o="/controle-estoque-web/api/materialcategory/remover/",n="/controle-estoque-web/api/materialcategory/listar/",s={cadastrar:e,excluir:t,listarTodas:r};return s}angular.module("app").factory("materialCategoryService",a),a.$inject=["$http","$location"]}(),function(){"use strict";function a(a){function e(e){return a.post(i,e)}function t(e){return a.post(o,e)}function r(){return a.post(n)}var i="/controle-estoque-web/api/material/cadastrar/",o="/controle-estoque-web/api/material/remover/",n="/controle-estoque-web/api/material/listar/",s={cadastrar:e,excluir:t,listarTodas:r};return s}angular.module("app").factory("materiaPrimaService",a),a.$inject=["$http","$location"]}(),function(){"use strict";function a(a){a.theme("default").primaryPalette("purple",{"default":"400","hue-1":"100","hue-2":"600","hue-3":"A100"}).accentPalette("purple",{"default":"200"})}angular.module("app").config(a),a.$inject=["$mdThemingProvider","$locationProvider"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZhcm8uYXBwLmpzIiwidG9hc3Quc2VydmljZS5qcyIsInJvdXRlci5hcHAuanMiLCJhcHAuY29uZmFyby5taW4uanMiLCJjYWRhc3Ryby9jYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIuanMiLCJzZXJ2aWNlL3NlcnZpY2VNYXRlcmlhbENhdGVnb3J5LmpzIiwic2VydmljZS9zZXJ2aWNlTWF0ZXJpYVByaW1hLmpzIiwiYXBwLWNvbmZpZy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGh0dHBQcm92aWRlciIsInRvYXN0QXBwIiwiJG1kVG9hc3QiLCJuZXdtZXNzYWdlIiwiZXJyb3JNZXNzYWdlIiwidGhpcyIsIm1lc3NhZ2UiLCJzaG93IiwiY29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsInRlbXBsYXRlVXJsIiwiYWN0aW9uIiwiaGlnaGxpZ2h0QWN0aW9uIiwicG9zaXRpb24iLCJoaWRlRGVsYXkiLCJlcnJvck1lc3NhZ2VCb3R0b20iLCJzZXJ2aWNlIiwic2VsZiIsImNsb3NlVG9hc3QiLCJoaWRlIiwiZmFjdG9yeSIsIiRpbmplY3QiLCJyb3V0ZXMiLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsInN0YXRlIiwidXJsIiwib3RoZXJ3aXNlIiwiY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyIiwibWF0ZXJpYVByaW1hU2VydmljZSIsIiRtZERpYWxvZyIsImJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEiLCJsaXN0YVVuaWRhZGVzIiwic2VsZWNpb25hck1hdGVyaWFQcmltYSIsIm1hdGVyaWFQcmltYSIsIm1hdGVyaWFwcmltYSIsImlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hIiwiaW5pdGNhZGFzdHJvTWF0ZXJpYVByaW1hIiwibGlzdGFyVG9kYXMiLCJzdWNjZXNzIiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJsaXN0YU1hdGVyaWFQcmltYSIsImV4Y2x1aXJNYXRlcmlhUHJpbWEiLCJldiIsImNvbmZpcm0iLCJwYXJlbnQiLCJlbGVtZW50IiwiZG9jdW1lbnQiLCJib2R5IiwidGl0bGUiLCJza3VDb2RlIiwiY29udGVudCIsIm5hbWUiLCJhcmlhTGFiZWwiLCJvayIsImNhbmNlbCIsInRhcmdldEV2ZW50IiwidGhlbiIsImV4Y2x1aXIiLCJpIiwibGVuZ3RoIiwiaWQiLCJzcGxpY2UiLCJza3UiLCJtZWFzdXJpbmdVbml0IiwiZGVzY3JpcHRpb24iLCJjYWRhc3RyYXJNYXRlcmlhUHJpbWEiLCJjYWRhc3RyYXIiLCJwdXNoIiwib3JkZW5hTWF0ZXJpYVByaW1hIiwiY2FtcG9PcmRlbmNhbyIsInJldmVyc2UiLCJtYXRlcmlhbENhdGVnb3J5U2VydmljZSIsIiRodHRwIiwicG9zdCIsIkFQSV9ST1VURV9DQURBU1RSQVJNQVRFUklBTFBSSU1BIiwiQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEiLCJBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BIiwiYXBwQ29uZmlnIiwiJG1kVGhlbWluZ1Byb3ZpZGVyIiwidGhlbWUiLCJwcmltYXJ5UGFsZXR0ZSIsImRlZmF1bHQiLCJodWUtMSIsImh1ZS0yIiwiaHVlLTMiLCJhY2NlbnRQYWxldHRlIl0sIm1hcHBpbmdzIjoiQ0FJQSxXQUNBLFlBQ0FBLFNBQ0FDLE9BQUEsT0FBQSxZQUFBLGVBQUEsZUFDQUMsUUFBQSxnQkFBQSxTQUFBQyxVQ0xBLFdBRUEsWUFjQSxTQUFBQyxHQUFBQyxHQWlCQSxRQUFBQyxHQUFBQyxHQUNBQyxLQUFBQyxRQUFBRixFQUNBRixFQUFBSyxNQUVBQyxXQUFBLGtCQUNBQyxhQUFBLEtBQ0FDLFlBQUEscURBQ0FDLE9BQUEsS0FDQUMsaUJBQUEsRUFDQUMsU0FBQSxZQUNBQyxVQUFBLE1BS0EsUUFBQUMsR0FBQVgsR0FDQUMsS0FBQUMsUUFBQUYsRUFDQUYsRUFBQUssTUFFQUMsV0FBQSxrQkFDQUMsYUFBQSxLQUNBQyxZQUFBLDRCQUNBQyxPQUFBLEtBQ0FDLGlCQUFBLEVBQ0FDLFNBQUEs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UUFDQUMsT0FBQSxPQUNBQyxPQUFBaUYsR0FFQUEsRUFBQTNELFNBQUEscUJBQUEiLCJmaWxlIjoiYXBwLmNvbmZhcm8ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTAvMDUvMjAxNi5cclxuICovXHJcblxyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwJyxbJ3VpLnJvdXRlcicsJ3RvYXN0U2VydmljZScsJ25nTWF0ZXJpYWwnXSlcclxuICAgICAgICAuY29uZmlnKGZ1bmN0aW9uKCRodHRwUHJvdmlkZXIpIHtcclxuICAgICAgICAgICAgLyokaHR0cFByb3ZpZGVyLmludGVyY2VwdG9ycy5wdXNoKCdBdXRoSW50ZXJjZXB0b3InKTsqL1xyXG4gICAgICAgIH0pXHJcblxyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEpPU0VWQUxERVJMRUkgb24gMjcvMDYvMjAxNS5cclxuICovXHJcbihmdW5jdGlvbigpe1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgndG9hc3RTZXJ2aWNlJyxbXSlcclxuICAgICAgICAuY29udHJvbGxlcigndG9hc3RDb250cm9sbGVyJywgZnVuY3Rpb24oJG1kVG9hc3QsdG9hc3RBcHApIHtcclxuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgICAgICAgICBzZWxmLm1lc3NhZ2UgPSAgdG9hc3RBcHAubWVzc2FnZTtcclxuICAgICAgICAgICAgc2VsZi5jbG9zZVRvYXN0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5oaWRlKCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZmFjdG9yeSggJ3RvYXN0QXBwJywgdG9hc3RBcHAgKTtcclxuXHJcbiAgICB0b2FzdEFwcC4kaW5qZWN0ID0gWyAnJG1kVG9hc3QnIF07XHJcblxyXG4gICAgZnVuY3Rpb24gdG9hc3RBcHAgKCRtZFRvYXN0KSB7XHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIG1lc3NhZ2U6ICcnLFxyXG4gICAgICAgICAgICBuZXdtZXNzYWdlOiBuZXdtZXNzYWdlLFxyXG4gICAgICAgICAgICBlcnJvck1lc3NhZ2VCb3R0b206IGVycm9yTWVzc2FnZUJvdHRvbVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XHJcblxyXG4gICAgICAgIC8qZnVuY3Rpb24gZXJyb3JNZXNzYWdlKGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxyXG4gICAgICAgICAgICAgICAgJG1kVG9hc3Quc2ltcGxlKClcclxuICAgICAgICAgICAgICAgIC50ZXh0Q29udGVudChlcnJvck1lc3NhZ2UpXHJcbiAgICAgICAgICAgICAgICAucG9zaXRpb24oJ3RvcCByaWdodCcpXHJcbiAgICAgICAgICAgICAgICAuaGlkZURlbGF5KDgwMClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9Ki9cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbmV3bWVzc2FnZShlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd0b2FzdENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbnRyb2xlLWVzdG9xdWUtd2ViL2NsaWVudC92aWV3cy9mb3Jtcy90b2FzdC5odG1sJyxcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IFwiT0tcIixcclxuICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRBY3Rpb246IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFwidG9wIHJpZ2h0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgaGlkZURlbGF5OiAyMDAwXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBlcnJvck1lc3NhZ2VCb3R0b20oZXJyb3JNZXNzYWdlKSB7XHJcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZSA9IGVycm9yTWVzc2FnZTtcclxuICAgICAgICAgICAgJG1kVG9hc3Quc2hvdyhcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAndG9hc3RDb250cm9sbGVyJyxcclxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyQXM6ICd2bScsXHJcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2aWV3cy9wYWdlcy9kc2N0b2FzdC5odG1sJyxcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IFwiT0tcIixcclxuICAgICAgICAgICAgICAgICAgICBoaWdobGlnaHRBY3Rpb246IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IFwiYm90dG9tIGxlZnRcIixcclxuICAgICAgICAgICAgICAgICAgICBoaWRlRGVsYXk6IDEwMDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG59KSgpO1xyXG5cclxuXHJcblxyXG5cclxuXHJcbiIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IEpPU0VWQUxERVJMRUkgb24gMjUvMDYvMjAxNS5cclxuICovXHJcbihmdW5jdGlvbigpe1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmNvbmZpZyhyb3V0ZXMpO1xyXG4gICAgZnVuY3Rpb24gcm91dGVzKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcclxuICAgICAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY2FkYXN0cm9NYXRlcmlhUHJpbWEnLCB7XHJcbiAgICAgICAgICAgIHVybDogJy8nLFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2NvbnRyb2xlLWVzdG9xdWUtd2ViL2NsaWVudC92aWV3cy9mb3Jtcy9jYWRfbWF0ZXJpYXByaW1hLmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiAnY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyIGFzIHZtJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XHJcblxyXG4gICAgfVxyXG5cclxufSkoKTtcclxuIiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTAvMDUvMjAxNi5cclxuICovXHJcblxyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwJyxbJ3VpLnJvdXRlcicsJ3RvYXN0U2VydmljZScsJ25nTWF0ZXJpYWwnXSlcclxuICAgICAgICAuY29uZmlnKFtcIiRodHRwUHJvdmlkZXJcIiwgZnVuY3Rpb24oJGh0dHBQcm92aWRlcikge1xyXG4gICAgICAgICAgICAvKiRodHRwUHJvdmlkZXIuaW50ZXJjZXB0b3JzLnB1c2goJ0F1dGhJbnRlcmNlcHRvcicpOyovXHJcbiAgICAgICAgfV0pXHJcblxyXG59KSgpO1xuLyoqXHJcbiAqIENyZWF0ZWQgYnkgSk9TRVZBTERFUkxFSSBvbiAyNy8wNi8yMDE1LlxyXG4gKi9cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCd0b2FzdFNlcnZpY2UnLFtdKVxyXG4gICAgICAgIC5jb250cm9sbGVyKCd0b2FzdENvbnRyb2xsZXInLCBbXCIkbWRUb2FzdFwiLCBcInRvYXN0QXBwXCIsIGZ1bmN0aW9uKCRtZFRvYXN0LHRvYXN0QXBwKSB7XHJcbiAgICAgICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICAgICAgc2VsZi5tZXNzYWdlID0gIHRvYXN0QXBwLm1lc3NhZ2U7XHJcbiAgICAgICAgICAgIHNlbGYuY2xvc2VUb2FzdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJG1kVG9hc3QuaGlkZSgpO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1dKVxyXG4gICAgICAgIC5mYWN0b3J5KCAndG9hc3RBcHAnLCB0b2FzdEFwcCApO1xyXG5cclxuICAgIHRvYXN0QXBwLiRpbmplY3QgPSBbICckbWRUb2FzdCcgXTtcclxuXHJcbiAgICBmdW5jdGlvbiB0b2FzdEFwcCAoJG1kVG9hc3QpIHtcclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgbWVzc2FnZTogJycsXHJcbiAgICAgICAgICAgIG5ld21lc3NhZ2U6IG5ld21lc3NhZ2UsXHJcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZUJvdHRvbTogZXJyb3JNZXNzYWdlQm90dG9tXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgLypmdW5jdGlvbiBlcnJvck1lc3NhZ2UoZXJyb3JNZXNzYWdlKSB7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICAkbWRUb2FzdC5zaW1wbGUoKVxyXG4gICAgICAgICAgICAgICAgLnRleHRDb250ZW50KGVycm9yTWVzc2FnZSlcclxuICAgICAgICAgICAgICAgIC5wb3NpdGlvbigndG9wIHJpZ2h0JylcclxuICAgICAgICAgICAgICAgIC5oaWRlRGVsYXkoODAwKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0qL1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBuZXdtZXNzYWdlKGVycm9yTWVzc2FnZSkge1xyXG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2UgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICAgICAgICAgICRtZFRvYXN0LnNob3coXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3RvYXN0Q29udHJvbGxlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxyXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnY29udHJvbGUtZXN0b3F1ZS13ZWIvY2xpZW50L3ZpZXdzL2Zvcm1zL3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogXCJPS1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodEFjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJ0b3AgcmlnaHRcIixcclxuICAgICAgICAgICAgICAgICAgICBoaWRlRGVsYXk6IDIwMDBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yTWVzc2FnZUJvdHRvbShlcnJvck1lc3NhZ2UpIHtcclxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgICAgICAgICAkbWRUb2FzdC5zaG93KFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICd0b2FzdENvbnRyb2xsZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcclxuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZpZXdzL3BhZ2VzL2RzY3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogXCJPS1wiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZ2hsaWdodEFjdGlvbjogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJib3R0b20gbGVmdFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhpZGVEZWxheTogMTAwMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcblxyXG5cclxuXG4vKipcclxuICogQ3JlYXRlZCBieSBKT1NFVkFMREVSTEVJIG9uIDI1LzA2LzIwMTUuXHJcbiAqL1xyXG4oZnVuY3Rpb24oKXtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5jb25maWcocm91dGVzKTtcclxuICAgIGZ1bmN0aW9uIHJvdXRlcygkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XHJcbiAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NhZGFzdHJvTWF0ZXJpYVByaW1hJywge1xyXG4gICAgICAgICAgICB1cmw6ICcvJyxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdjb250cm9sZS1lc3RvcXVlLXdlYi9jbGllbnQvdmlld3MvZm9ybXMvY2FkX21hdGVyaWFwcmltYS5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogJ2NhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlciBhcyB2bSdcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xyXG5cclxuICAgIH1cclxuICAgIHJvdXRlcy4kaW5qZWN0ID0gW1wiJHN0YXRlUHJvdmlkZXJcIiwgXCIkdXJsUm91dGVyUHJvdmlkZXJcIl07XHJcblxyXG59KSgpO1xyXG5cbi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDEwLzA1LzIwMTYuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgICAgIC5jb250cm9sbGVyKCdjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXInLCBjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlcih0b2FzdEFwcCwgbWF0ZXJpYVByaW1hU2VydmljZSwgJG1kRGlhbG9nKSB7XHJcblxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLmluaXRjYWRhc3Ryb01hdGVyaWFQcmltYSA9IGluaXRjYWRhc3Ryb01hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmNhZGFzdHJhck1hdGVyaWFQcmltYSA9IGNhZGFzdHJhck1hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEgPSBidXNjYVVuaWRhZGVzTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuZXhjbHVpck1hdGVyaWFQcmltYSA9IGV4Y2x1aXJNYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgc2VsZi5saXN0YVVuaWRhZGVzO1xyXG4gICAgICAgIHNlbGYuaXNCdG5SZW1vdmVNYXRlcmlhUHJpbWEgPSBmYWxzZTtcclxuICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHt9O1xyXG4gICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEgPSBbXTtcclxuICAgICAgICBzZWxmLnNlbGVjaW9uYXJNYXRlcmlhUHJpbWEgPSBzZWxlY2lvbmFyTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuY2FtcG9PcmRlbmNhbyA9ICdub21lJztcclxuICAgICAgICBzZWxmLnJldmVyc2UgPSB0cnVlO1xyXG4gICAgICAgIHNlbGYub3JkZW5hTWF0ZXJpYVByaW1hID0gb3JkZW5hTWF0ZXJpYVByaW1hO1xyXG5cclxuXHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBidXNjYVVuaWRhZGVzTWF0ZXJpYVByaW1hKCkge1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RhVW5pZGFkZXMgPSBbJ0tnJywgJ20nXVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2VsZWNpb25hck1hdGVyaWFQcmltYShtYXRlcmlhUHJpbWEpIHtcclxuICAgICAgICAgICAgc2VsZi5tYXRlcmlhcHJpbWEgPSBtYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgICAgIHNlbGYuaXNCdG5SZW1vdmVNYXRlcmlhUHJpbWEgPSB0cnVlO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGluaXRjYWRhc3Ryb01hdGVyaWFQcmltYSgpIHtcclxuICAgICAgICAgICAgbWF0ZXJpYVByaW1hU2VydmljZS5saXN0YXJUb2RhcygpXHJcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEgPSBkYXRhO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgICAgICAvKiAgdmFyIG1hdGVyaWFwcmltYSA9IHtpZDogMSwgbm9tZTogXCJYIFRlY2lkb1wiLCBza3U6IFwiMDAwMDBYOTk5XCIsIHVuaWRhZGU6IFwiS0dcIiwgb2JzZXJ2YWNhbzogXCJUZXN0ZSBkZSBYXCJ9O1xyXG4gICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiAgICAgICAgICAgICB2YXIgbWF0ZXJpYXByaW1hID0ge2lkOiAyLCBub21lOiBcIkIgVGVjaWRvXCIsIHNrdTogXCIwMDAwMEIwMDNcIiwgdW5pZGFkZTogXCJLR1wiLCBvYnNlcnZhY2FvOiBcIlRlc3RlIGRlIEJcIn07XHJcbiAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2gobWF0ZXJpYXByaW1hKTtcclxuICAgICAgICAgICAgIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IDMsIG5vbWU6IFwiQSBUZWNpZG9cIiwgc2t1OiBcIjAwMDAwWDk5OVwiLCB1bmlkYWRlOiBcIktHXCIsIG9ic2VydmFjYW86IFwiVGVzdGUgZGUgQVwifTtcclxuICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhcHJpbWEpO1xyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGNsdWlyTWF0ZXJpYVByaW1hKGV2LCBtYXRlcmlhUHJpbWEpIHtcclxuICAgICAgICAgICAgdmFyIGNvbmZpcm0gPSAkbWREaWFsb2cuY29uZmlybSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLnBhcmVudChhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRpdGxlKCdFeGNsdWlyIE1hdMOpcmlhIHByaW1hIGNvbSBTa3UnICsgbWF0ZXJpYVByaW1hLnNrdUNvZGUpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbnRlbnQoJ01hdGVyaWEgUHJpbWE6ICcgKyBtYXRlcmlhUHJpbWEubmFtZSlcclxuICAgICAgICAgICAgICAgICAgICAuYXJpYUxhYmVsKCdFeGNsdWlyIE1hdGVyaWEgUHJpbWEnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vaygnU2ltJylcclxuICAgICAgICAgICAgICAgICAgICAuY2FuY2VsKCdOw6NvJylcclxuICAgICAgICAgICAgICAgICAgICAudGFyZ2V0RXZlbnQoZXYpO1xyXG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyhjb25maXJtKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIG1hdGVyaWFQcmltYVNlcnZpY2UuZXhjbHVpcihtYXRlcmlhUHJpbWEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hW2ldLmlkID09PSBtYXRlcmlhUHJpbWEuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdSZW1vdmlkbyBjb20gc3VjZXNzbyEuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ1Byb2JsZW1hIGFvIEFjZXNzYXIgbyBzZXJ2aWRvcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYubGlzdGFNYXRlcmlhUHJpbWEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLmxpc3RhTWF0ZXJpYVByaW1hW2ldLmlkICsgJyA9PT0gJyArIG1hdGVyaWFQcmltYS5pZClcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5saXN0YU1hdGVyaWFQcmltYVtpXS5pZCA9PT0gbWF0ZXJpYVByaW1hLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxmLmlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdSZW1vdmlkbyBhIE1hdGVyaWEgUHJpbWEgY29tIG8gU0tVLicgKyBtYXRlcmlhUHJpbWEuc2t1KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHtpZDogbnVsbCwgbmFtZTogXCJcIiwgc2t1Q29kZTogXCJcIiwgbWVhc3VyaW5nVW5pdDogXCJcIiwgZGVzY3JpcHRpb246IFwiXCJ9O1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGNhZGFzdHJhck1hdGVyaWFQcmltYShtYXRlcmlhUHJpbWEpIHtcclxuXHJcbiAgICAgICAgICAgIG1hdGVyaWFQcmltYVNlcnZpY2UuY2FkYXN0cmFyKG1hdGVyaWFQcmltYSlcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhUHJpbWEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnQ2FkYXN0cm8gcmVhbGl6YWRvIGNvbSBzdWNlc3NvIScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnUHJvYmxlbWEgYW8gQWNlc3NhciBhIG8gc2Vydmlkb3InKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLyogIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IHNlbGYubGlzdGFNYXRlcmlhUHJpbWEubGVuZ3RoKzEsIG5vbWU6IG1hdGVyaWFQcmltYS5ub21lLCBza3U6IG1hdGVyaWFQcmltYS5za3UsIHVuaWRhZGU6IG1hdGVyaWFQcmltYS51bmlkYWRlLCBvYnNlcnZhY2FvOiBtYXRlcmlhUHJpbWEub2JzZXJ2YWNhb307XHJcbiAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2gobWF0ZXJpYXByaW1hKTtcclxuICAgICAgICAgICAgIHNlbGYubWF0ZXJpYXByaW1hID0ge2lkOiBudWxsLG5vbWU6IFwiXCIsIHNrdTogXCJcIiwgdW5pZGFkZTogXCJcIiwgb2JzZXJ2YWNhbzogXCJcIn07XHJcbiAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdDYWRhc3RybyByZWFsaXphZG8gY29tIHN1Y2Vzc28gcGFyYSBvIFNLVS4nICsgbWF0ZXJpYVByaW1hLnNrdSk7XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb3JkZW5hTWF0ZXJpYVByaW1hKGNhbXBvT3JkZW5jYW8pIHtcclxuICAgICAgICAgICAgc2VsZi5yZXZlcnNlID0gKHNlbGYuY2FtcG9PcmRlbmNhbyA9PT0gY2FtcG9PcmRlbmNhbykgPyAhc2VsZi5yZXZlcnNlIDogZmFsc2U7XHJcbiAgICAgICAgICAgIHNlbGYuY2FtcG9PcmRlbmNhbyA9IGNhbXBvT3JkZW5jYW87XHJcblxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG4gICAgY2FkYXN0cm9NYXRlcmlhUHJpbWFDb250cm9sbGVyLiRpbmplY3QgPSBbXCJ0b2FzdEFwcFwiLCBcIm1hdGVyaWFQcmltYVNlcnZpY2VcIiwgXCIkbWREaWFsb2dcIl07XHJcblxyXG59KSgpO1xuLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTEvMDUvMjAxNi5cclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5mYWN0b3J5KCdtYXRlcmlhbENhdGVnb3J5U2VydmljZScsIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlKTtcclxuXHJcbiAgICBtYXRlcmlhbENhdGVnb3J5U2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsJyRsb2NhdGlvbiddO1xyXG5cclxuICAgIGZ1bmN0aW9uIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlKCRodHRwKSB7XHJcblxyXG4gICAgICAgIHZhciBBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsY2F0ZWdvcnkvY2FkYXN0cmFyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWxjYXRlZ29yeS9yZW1vdmVyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEgPSAnL2NvbnRyb2xlLWVzdG9xdWUtd2ViL2FwaS9tYXRlcmlhbGNhdGVnb3J5L2xpc3Rhci8nO1xyXG5cclxuXHJcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XHJcbiAgICAgICAgICAgIGNhZGFzdHJhcjogY2FkYXN0cmFyLFxyXG4gICAgICAgICAgICBleGNsdWlyOiBleGNsdWlyLFxyXG4gICAgICAgICAgICBsaXN0YXJUb2RhczogbGlzdGFyVG9kYXNcclxuXHJcbiAgICAgICAgfTtcclxuICAgICAgICByZXR1cm4gc2VydmljZTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2FkYXN0cmFyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0NBREFTVFJBUk1BVEVSSUFMUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZXhjbHVpcihkYXRhKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BLCBkYXRhKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGxpc3RhclRvZGFzKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgIH1cclxuXHJcblxyXG59KSgpO1xuLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTEvMDUvMjAxNi5cclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5mYWN0b3J5KCdtYXRlcmlhUHJpbWFTZXJ2aWNlJywgbWF0ZXJpYVByaW1hU2VydmljZSk7XHJcblxyXG4gICAgbWF0ZXJpYVByaW1hU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsJyRsb2NhdGlvbiddO1xyXG5cclxuICAgIGZ1bmN0aW9uIG1hdGVyaWFQcmltYVNlcnZpY2UoJGh0dHApIHtcclxuXHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9DQURBU1RSQVJNQVRFUklBTFBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWwvY2FkYXN0cmFyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWwvcmVtb3Zlci8nO1xyXG4gICAgICAgIHZhciBBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWwvbGlzdGFyLyc7XHJcblxyXG5cclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgY2FkYXN0cmFyOiBjYWRhc3RyYXIsXHJcbiAgICAgICAgICAgIGV4Y2x1aXI6IGV4Y2x1aXIsXHJcbiAgICAgICAgICAgIGxpc3RhclRvZGFzOiBsaXN0YXJUb2Rhc1xyXG5cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjYWRhc3RyYXIoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGNsdWlyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGlzdGFyVG9kYXMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuXHJcbn0pKCk7XG4vKipcclxuICogQ3JlYXRlZCBieSBqZXN1cyBvbiAwNi8wNS8yMDE2LlxyXG4gKi9cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5jb25maWcoYXBwQ29uZmlnKTtcclxuXHJcbiAgICBhcHBDb25maWcuJGluamVjdCA9IFsnJG1kVGhlbWluZ1Byb3ZpZGVyJywnJGxvY2F0aW9uUHJvdmlkZXInXTtcclxuXHJcbiAgICBmdW5jdGlvbiBhcHBDb25maWcoJG1kVGhlbWluZ1Byb3ZpZGVyKSB7XHJcbiAgICAgICAgJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdkZWZhdWx0JylcclxuICAgICAgICAgICAgLnByaW1hcnlQYWxldHRlKCdwdXJwbGUnLCB7XHJcbiAgICAgICAgICAgICAgICAnZGVmYXVsdCc6ICc0MDAnLCAvLyBieSBkZWZhdWx0IHVzZSBzaGFkZSA0MDAgZnJvbSB0aGUgcGluayBwYWxldHRlIGZvciBwcmltYXJ5IGludGVudGlvbnNcclxuICAgICAgICAgICAgICAgICdodWUtMSc6ICcxMDAnLCAvLyB1c2Ugc2hhZGUgMTAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTE8L2NvZGU+IGNsYXNzXHJcbiAgICAgICAgICAgICAgICAnaHVlLTInOiAnNjAwJywgLy8gdXNlIHNoYWRlIDYwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0yPC9jb2RlPiBjbGFzc1xyXG4gICAgICAgICAgICAgICAgJ2h1ZS0zJzogJ0ExMDAnIC8vIHVzZSBzaGFkZSBBMTAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTM8L2NvZGU+IGNsYXNzXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC8vIElmIHlvdSBzcGVjaWZ5IGxlc3MgdGhhbiBhbGwgb2YgdGhlIGtleXMsIGl0IHdpbGwgaW5oZXJpdCBmcm9tIHRoZVxyXG4gICAgICAgICAgICAvLyBkZWZhdWx0IHNoYWRlc1xyXG4gICAgICAgICAgICAuYWNjZW50UGFsZXR0ZSgncHVycGxlJywge1xyXG4gICAgICAgICAgICAgICAgJ2RlZmF1bHQnOiAnMjAwJyAvLyB1c2Ugc2hhZGUgMjAwIGZvciBkZWZhdWx0LCBhbmQga2VlcCBhbGwgb3RoZXIgc2hhZGVzIHRoZSBzYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuXHJcblxyXG59KSgpOyIsIi8qKlxyXG4gKiBDcmVhdGVkIGJ5IGplc3VzIG9uIDEwLzA1LzIwMTYuXHJcbiAqL1xyXG5cclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgICAgIC5jb250cm9sbGVyKCdjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXInLCBjYWRhc3Ryb01hdGVyaWFQcmltYUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNhZGFzdHJvTWF0ZXJpYVByaW1hQ29udHJvbGxlcih0b2FzdEFwcCwgbWF0ZXJpYVByaW1hU2VydmljZSwgJG1kRGlhbG9nKSB7XHJcblxyXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgICAgICBzZWxmLmluaXRjYWRhc3Ryb01hdGVyaWFQcmltYSA9IGluaXRjYWRhc3Ryb01hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmNhZGFzdHJhck1hdGVyaWFQcmltYSA9IGNhZGFzdHJhck1hdGVyaWFQcmltYTtcclxuICAgICAgICBzZWxmLmJ1c2NhVW5pZGFkZXNNYXRlcmlhUHJpbWEgPSBidXNjYVVuaWRhZGVzTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuZXhjbHVpck1hdGVyaWFQcmltYSA9IGV4Y2x1aXJNYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgc2VsZi5saXN0YVVuaWRhZGVzO1xyXG4gICAgICAgIHNlbGYuaXNCdG5SZW1vdmVNYXRlcmlhUHJpbWEgPSBmYWxzZTtcclxuICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHt9O1xyXG4gICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEgPSBbXTtcclxuICAgICAgICBzZWxmLnNlbGVjaW9uYXJNYXRlcmlhUHJpbWEgPSBzZWxlY2lvbmFyTWF0ZXJpYVByaW1hO1xyXG4gICAgICAgIHNlbGYuY2FtcG9PcmRlbmNhbyA9ICdub21lJztcclxuICAgICAgICBzZWxmLnJldmVyc2UgPSB0cnVlO1xyXG4gICAgICAgIHNlbGYub3JkZW5hTWF0ZXJpYVByaW1hID0gb3JkZW5hTWF0ZXJpYVByaW1hO1xyXG5cclxuXHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBidXNjYVVuaWRhZGVzTWF0ZXJpYVByaW1hKCkge1xyXG4gICAgICAgICAgICBzZWxmLmxpc3RhVW5pZGFkZXMgPSBbJ0tnJywgJ20nXVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2VsZWNpb25hck1hdGVyaWFQcmltYShtYXRlcmlhUHJpbWEpIHtcclxuICAgICAgICAgICAgc2VsZi5tYXRlcmlhcHJpbWEgPSBtYXRlcmlhUHJpbWE7XHJcbiAgICAgICAgICAgIHNlbGYuaXNCdG5SZW1vdmVNYXRlcmlhUHJpbWEgPSB0cnVlO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGluaXRjYWRhc3Ryb01hdGVyaWFQcmltYSgpIHtcclxuICAgICAgICAgICAgbWF0ZXJpYVByaW1hU2VydmljZS5saXN0YXJUb2RhcygpXHJcbiAgICAgICAgICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24gKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEgPSBkYXRhO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgICAgICAvKiAgdmFyIG1hdGVyaWFwcmltYSA9IHtpZDogMSwgbm9tZTogXCJYIFRlY2lkb1wiLCBza3U6IFwiMDAwMDBYOTk5XCIsIHVuaWRhZGU6IFwiS0dcIiwgb2JzZXJ2YWNhbzogXCJUZXN0ZSBkZSBYXCJ9O1xyXG4gICAgICAgICAgICAgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5wdXNoKG1hdGVyaWFwcmltYSk7XHJcbiAgICAgICAgICAgICB2YXIgbWF0ZXJpYXByaW1hID0ge2lkOiAyLCBub21lOiBcIkIgVGVjaWRvXCIsIHNrdTogXCIwMDAwMEIwMDNcIiwgdW5pZGFkZTogXCJLR1wiLCBvYnNlcnZhY2FvOiBcIlRlc3RlIGRlIEJcIn07XHJcbiAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2gobWF0ZXJpYXByaW1hKTtcclxuICAgICAgICAgICAgIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IDMsIG5vbWU6IFwiQSBUZWNpZG9cIiwgc2t1OiBcIjAwMDAwWDk5OVwiLCB1bmlkYWRlOiBcIktHXCIsIG9ic2VydmFjYW86IFwiVGVzdGUgZGUgQVwifTtcclxuICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhcHJpbWEpO1xyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGNsdWlyTWF0ZXJpYVByaW1hKGV2LCBtYXRlcmlhUHJpbWEpIHtcclxuICAgICAgICAgICAgdmFyIGNvbmZpcm0gPSAkbWREaWFsb2cuY29uZmlybSgpXHJcbiAgICAgICAgICAgICAgICAgICAgLnBhcmVudChhbmd1bGFyLmVsZW1lbnQoZG9jdW1lbnQuYm9keSkpXHJcbiAgICAgICAgICAgICAgICAgICAgLnRpdGxlKCdFeGNsdWlyIE1hdMOpcmlhIHByaW1hIGNvbSBTa3UnICsgbWF0ZXJpYVByaW1hLnNrdUNvZGUpXHJcbiAgICAgICAgICAgICAgICAgICAgLmNvbnRlbnQoJ01hdGVyaWEgUHJpbWE6ICcgKyBtYXRlcmlhUHJpbWEubmFtZSlcclxuICAgICAgICAgICAgICAgICAgICAuYXJpYUxhYmVsKCdFeGNsdWlyIE1hdGVyaWEgUHJpbWEnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vaygnU2ltJylcclxuICAgICAgICAgICAgICAgICAgICAuY2FuY2VsKCdOw6NvJylcclxuICAgICAgICAgICAgICAgICAgICAudGFyZ2V0RXZlbnQoZXYpO1xyXG4gICAgICAgICAgICAkbWREaWFsb2cuc2hvdyhjb25maXJtKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIG1hdGVyaWFQcmltYVNlcnZpY2UuZXhjbHVpcihtYXRlcmlhUHJpbWEpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5saXN0YU1hdGVyaWFQcmltYS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hW2ldLmlkID09PSBtYXRlcmlhUHJpbWEuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdSZW1vdmlkbyBjb20gc3VjZXNzbyEuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvYXN0QXBwLm5ld21lc3NhZ2UoJ1Byb2JsZW1hIGFvIEFjZXNzYXIgbyBzZXJ2aWRvcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYubGlzdGFNYXRlcmlhUHJpbWEubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLmxpc3RhTWF0ZXJpYVByaW1hW2ldLmlkICsgJyA9PT0gJyArIG1hdGVyaWFQcmltYS5pZClcclxuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZi5saXN0YU1hdGVyaWFQcmltYVtpXS5pZCA9PT0gbWF0ZXJpYVByaW1hLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEuc3BsaWNlKGksIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBzZWxmLmlzQnRuUmVtb3ZlTWF0ZXJpYVByaW1hID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdSZW1vdmlkbyBhIE1hdGVyaWEgUHJpbWEgY29tIG8gU0tVLicgKyBtYXRlcmlhUHJpbWEuc2t1KTtcclxuXHJcbiAgICAgICAgICAgICAgICBzZWxmLm1hdGVyaWFwcmltYSA9IHtpZDogbnVsbCwgbmFtZTogXCJcIiwgc2t1Q29kZTogXCJcIiwgbWVhc3VyaW5nVW5pdDogXCJcIiwgZGVzY3JpcHRpb246IFwiXCJ9O1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGZ1bmN0aW9uIGNhZGFzdHJhck1hdGVyaWFQcmltYShtYXRlcmlhUHJpbWEpIHtcclxuXHJcbiAgICAgICAgICAgIG1hdGVyaWFQcmltYVNlcnZpY2UuY2FkYXN0cmFyKG1hdGVyaWFQcmltYSlcclxuICAgICAgICAgICAgICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGFNYXRlcmlhUHJpbWEucHVzaChtYXRlcmlhUHJpbWEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnQ2FkYXN0cm8gcmVhbGl6YWRvIGNvbSBzdWNlc3NvIScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9hc3RBcHAubmV3bWVzc2FnZSgnUHJvYmxlbWEgYW8gQWNlc3NhciBhIG8gc2Vydmlkb3InKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLyogIHZhciBtYXRlcmlhcHJpbWEgPSB7aWQ6IHNlbGYubGlzdGFNYXRlcmlhUHJpbWEubGVuZ3RoKzEsIG5vbWU6IG1hdGVyaWFQcmltYS5ub21lLCBza3U6IG1hdGVyaWFQcmltYS5za3UsIHVuaWRhZGU6IG1hdGVyaWFQcmltYS51bmlkYWRlLCBvYnNlcnZhY2FvOiBtYXRlcmlhUHJpbWEub2JzZXJ2YWNhb307XHJcbiAgICAgICAgICAgICBzZWxmLmxpc3RhTWF0ZXJpYVByaW1hLnB1c2gobWF0ZXJpYXByaW1hKTtcclxuICAgICAgICAgICAgIHNlbGYubWF0ZXJpYXByaW1hID0ge2lkOiBudWxsLG5vbWU6IFwiXCIsIHNrdTogXCJcIiwgdW5pZGFkZTogXCJcIiwgb2JzZXJ2YWNhbzogXCJcIn07XHJcbiAgICAgICAgICAgICB0b2FzdEFwcC5uZXdtZXNzYWdlKCdDYWRhc3RybyByZWFsaXphZG8gY29tIHN1Y2Vzc28gcGFyYSBvIFNLVS4nICsgbWF0ZXJpYVByaW1hLnNrdSk7XHJcbiAgICAgICAgICAgICAqL1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb3JkZW5hTWF0ZXJpYVByaW1hKGNhbXBvT3JkZW5jYW8pIHtcclxuICAgICAgICAgICAgc2VsZi5yZXZlcnNlID0gKHNlbGYuY2FtcG9PcmRlbmNhbyA9PT0gY2FtcG9PcmRlbmNhbykgPyAhc2VsZi5yZXZlcnNlIDogZmFsc2U7XHJcbiAgICAgICAgICAgIHNlbGYuY2FtcG9PcmRlbmNhbyA9IGNhbXBvT3JkZW5jYW87XHJcblxyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxufSkoKTsiLCIvKipcclxuICogQ3JlYXRlZCBieSBqZXN1cyBvbiAxMS8wNS8yMDE2LlxyXG4gKi9cclxuXHJcblxyXG4oZnVuY3Rpb24oKXtcclxuXHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAgICAgLmZhY3RvcnkoJ21hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlJywgbWF0ZXJpYWxDYXRlZ29yeVNlcnZpY2UpO1xyXG5cclxuICAgIG1hdGVyaWFsQ2F0ZWdvcnlTZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJywnJGxvY2F0aW9uJ107XHJcblxyXG4gICAgZnVuY3Rpb24gbWF0ZXJpYWxDYXRlZ29yeVNlcnZpY2UoJGh0dHApIHtcclxuXHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9DQURBU1RSQVJNQVRFUklBTFBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWxjYXRlZ29yeS9jYWRhc3RyYXIvJztcclxuICAgICAgICB2YXIgQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEgPSAnL2NvbnRyb2xlLWVzdG9xdWUtd2ViL2FwaS9tYXRlcmlhbGNhdGVnb3J5L3JlbW92ZXIvJztcclxuICAgICAgICB2YXIgQVBJX1JPVVRFX0xJU1RBUk1BVEVSSUFQUklNQSA9ICcvY29udHJvbGUtZXN0b3F1ZS13ZWIvYXBpL21hdGVyaWFsY2F0ZWdvcnkvbGlzdGFyLyc7XHJcblxyXG5cclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgY2FkYXN0cmFyOiBjYWRhc3RyYXIsXHJcbiAgICAgICAgICAgIGV4Y2x1aXI6IGV4Y2x1aXIsXHJcbiAgICAgICAgICAgIGxpc3RhclRvZGFzOiBsaXN0YXJUb2Rhc1xyXG5cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjYWRhc3RyYXIoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGNsdWlyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGlzdGFyVG9kYXMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuXHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMTEvMDUvMjAxNi5cclxuICovXHJcblxyXG5cclxuKGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdhcHAnKVxyXG4gICAgICAgIC5mYWN0b3J5KCdtYXRlcmlhUHJpbWFTZXJ2aWNlJywgbWF0ZXJpYVByaW1hU2VydmljZSk7XHJcblxyXG4gICAgbWF0ZXJpYVByaW1hU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCcsJyRsb2NhdGlvbiddO1xyXG5cclxuICAgIGZ1bmN0aW9uIG1hdGVyaWFQcmltYVNlcnZpY2UoJGh0dHApIHtcclxuXHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9DQURBU1RSQVJNQVRFUklBTFBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWwvY2FkYXN0cmFyLyc7XHJcbiAgICAgICAgdmFyIEFQSV9ST1VURV9FWENMVUlSTUFURVJJQVBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWwvcmVtb3Zlci8nO1xyXG4gICAgICAgIHZhciBBUElfUk9VVEVfTElTVEFSTUFURVJJQVBSSU1BID0gJy9jb250cm9sZS1lc3RvcXVlLXdlYi9hcGkvbWF0ZXJpYWwvbGlzdGFyLyc7XHJcblxyXG5cclxuICAgICAgICB2YXIgc2VydmljZSA9IHtcclxuICAgICAgICAgICAgY2FkYXN0cmFyOiBjYWRhc3RyYXIsXHJcbiAgICAgICAgICAgIGV4Y2x1aXI6IGV4Y2x1aXIsXHJcbiAgICAgICAgICAgIGxpc3RhclRvZGFzOiBsaXN0YXJUb2Rhc1xyXG5cclxuICAgICAgICB9O1xyXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjYWRhc3RyYXIoZGF0YSkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdChBUElfUk9VVEVfQ0FEQVNUUkFSTUFURVJJQUxQUklNQSwgZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBleGNsdWlyKGRhdGEpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoQVBJX1JPVVRFX0VYQ0xVSVJNQVRFUklBUFJJTUEsIGRhdGEpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbGlzdGFyVG9kYXMoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KEFQSV9ST1VURV9MSVNUQVJNQVRFUklBUFJJTUEpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuXHJcbn0pKCk7IiwiLyoqXHJcbiAqIENyZWF0ZWQgYnkgamVzdXMgb24gMDYvMDUvMjAxNi5cclxuICovXHJcbihmdW5jdGlvbigpe1xyXG5cclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnYXBwJylcclxuICAgICAgICAuY29uZmlnKGFwcENvbmZpZyk7XHJcblxyXG4gICAgYXBwQ29uZmlnLiRpbmplY3QgPSBbJyRtZFRoZW1pbmdQcm92aWRlcicsJyRsb2NhdGlvblByb3ZpZGVyJ107XHJcblxyXG4gICAgZnVuY3Rpb24gYXBwQ29uZmlnKCRtZFRoZW1pbmdQcm92aWRlcikge1xyXG4gICAgICAgICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnZGVmYXVsdCcpXHJcbiAgICAgICAgICAgIC5wcmltYXJ5UGFsZXR0ZSgncHVycGxlJywge1xyXG4gICAgICAgICAgICAgICAgJ2RlZmF1bHQnOiAnNDAwJywgLy8gYnkgZGVmYXVsdCB1c2Ugc2hhZGUgNDAwIGZyb20gdGhlIHBpbmsgcGFsZXR0ZSBmb3IgcHJpbWFyeSBpbnRlbnRpb25zXHJcbiAgICAgICAgICAgICAgICAnaHVlLTEnOiAnMTAwJywgLy8gdXNlIHNoYWRlIDEwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0xPC9jb2RlPiBjbGFzc1xyXG4gICAgICAgICAgICAgICAgJ2h1ZS0yJzogJzYwMCcsIC8vIHVzZSBzaGFkZSA2MDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMjwvY29kZT4gY2xhc3NcclxuICAgICAgICAgICAgICAgICdodWUtMyc6ICdBMTAwJyAvLyB1c2Ugc2hhZGUgQTEwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0zPC9jb2RlPiBjbGFzc1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAvLyBJZiB5b3Ugc3BlY2lmeSBsZXNzIHRoYW4gYWxsIG9mIHRoZSBrZXlzLCBpdCB3aWxsIGluaGVyaXQgZnJvbSB0aGVcclxuICAgICAgICAgICAgLy8gZGVmYXVsdCBzaGFkZXNcclxuICAgICAgICAgICAgLmFjY2VudFBhbGV0dGUoJ3B1cnBsZScsIHtcclxuICAgICAgICAgICAgICAgICdkZWZhdWx0JzogJzIwMCcgLy8gdXNlIHNoYWRlIDIwMCBmb3IgZGVmYXVsdCwgYW5kIGtlZXAgYWxsIG90aGVyIHNoYWRlcyB0aGUgc2FtZVxyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcblxyXG5cclxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
